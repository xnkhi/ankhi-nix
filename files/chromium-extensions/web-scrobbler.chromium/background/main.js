(function(){"use strict";const It="Disallowed",Je="Disabled",Ut="Error",_t="Ignored",Mt="Loading",Dt="Playing",zt="Paused",Bt="Scrobbled",Ft="Unknown",G="Unsupported",qt="Loved",$t="Unloved";function Ve(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var ee={exports:{}},Ht=ee.exports,Qe;function Gt(){return Qe||(Qe=1,(function(s,e){(function(t,a){a(s)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:Ht,function(t){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)t.exports=globalThis.browser;else{const a="The message port closed before a response was received.",r=n=>{const g={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(g).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class p extends WeakMap{constructor(i,h=void 0){super(h),this.createItem=i}get(i){return this.has(i)||this.set(i,this.createItem(i)),super.get(i)}}const j=c=>c&&typeof c=="object"&&typeof c.then=="function",R=(c,i)=>(...h)=>{n.runtime.lastError?c.reject(new Error(n.runtime.lastError.message)):i.singleCallbackArg||h.length<=1&&i.singleCallbackArg!==!1?c.resolve(h[0]):c.resolve(h)},k=c=>c==1?"argument":"arguments",M=(c,i)=>function(w,...y){if(y.length<i.minArgs)throw new Error(`Expected at least ${i.minArgs} ${k(i.minArgs)} for ${c}(), got ${y.length}`);if(y.length>i.maxArgs)throw new Error(`Expected at most ${i.maxArgs} ${k(i.maxArgs)} for ${c}(), got ${y.length}`);return new Promise((v,u)=>{if(i.fallbackToNoCallback)try{w[c](...y,R({resolve:v,reject:u},i))}catch(o){console.warn(`${c} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,o),w[c](...y),i.fallbackToNoCallback=!1,i.noCallback=!0,v()}else i.noCallback?(w[c](...y),v()):w[c](...y,R({resolve:v,reject:u},i))})},he=(c,i,h)=>new Proxy(i,{apply(w,y,v){return h.call(y,c,...v)}});let $=Function.call.bind(Object.prototype.hasOwnProperty);const D=(c,i={},h={})=>{let w=Object.create(null),y={has(u,o){return o in c||o in w},get(u,o,m){if(o in w)return w[o];if(!(o in c))return;let d=c[o];if(typeof d=="function")if(typeof i[o]=="function")d=he(c,c[o],i[o]);else if($(h,o)){let H=M(o,h[o]);d=he(c,c[o],H)}else d=d.bind(c);else if(typeof d=="object"&&d!==null&&($(i,o)||$(h,o)))d=D(d,i[o],h[o]);else if($(h,"*"))d=D(d,i[o],h["*"]);else return Object.defineProperty(w,o,{configurable:!0,enumerable:!0,get(){return c[o]},set(H){c[o]=H}}),d;return w[o]=d,d},set(u,o,m,d){return o in w?w[o]=m:c[o]=m,!0},defineProperty(u,o,m){return Reflect.defineProperty(w,o,m)},deleteProperty(u,o){return Reflect.deleteProperty(w,o)}},v=Object.create(c);return new Proxy(v,y)},z=c=>({addListener(i,h,...w){i.addListener(c.get(h),...w)},hasListener(i,h){return i.hasListener(c.get(h))},removeListener(i,h){i.removeListener(c.get(h))}}),fe=new p(c=>typeof c!="function"?c:function(h){const w=D(h,{},{getContent:{minArgs:0,maxArgs:0}});c(w)}),pe=new p(c=>typeof c!="function"?c:function(h,w,y){let v=!1,u,o=new Promise(X=>{u=function(I){v=!0,X(I)}}),m;try{m=c(h,w,u)}catch(X){m=Promise.reject(X)}const d=m!==!0&&j(m);if(m!==!0&&!d&&!v)return!1;const H=X=>{X.then(I=>{y(I)},I=>{let We;I&&(I instanceof Error||typeof I.message=="string")?We=I.message:We="An unexpected error occurred",y({__mozWebExtensionPolyfillReject__:!0,message:We})}).catch(I=>{console.error("Failed to send onMessage rejected reply",I)})};return H(d?m:o),!0}),we=({reject:c,resolve:i},h)=>{n.runtime.lastError?n.runtime.lastError.message===a?i():c(new Error(n.runtime.lastError.message)):h&&h.__mozWebExtensionPolyfillReject__?c(new Error(h.message)):i(h)},je=(c,i,h,...w)=>{if(w.length<i.minArgs)throw new Error(`Expected at least ${i.minArgs} ${k(i.minArgs)} for ${c}(), got ${w.length}`);if(w.length>i.maxArgs)throw new Error(`Expected at most ${i.maxArgs} ${k(i.maxArgs)} for ${c}(), got ${w.length}`);return new Promise((y,v)=>{const u=we.bind(null,{resolve:y,reject:v});w.push(u),h.sendMessage(...w)})},ye={devtools:{network:{onRequestFinished:z(fe)}},runtime:{onMessage:z(pe),onMessageExternal:z(pe),sendMessage:je.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:je.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},l={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return g.privacy={network:{"*":l},services:{"*":l},websites:{"*":l}},D(n,ye,g)};t.exports=r(chrome)}})})(ee)),ee.exports}var Kt=Gt();const b=Ve(Kt),Ye="*",Wt="[hidden]",Jt=50;function U(s,e="log"){const t=console[e];if(typeof t!="function")throw new TypeError(`Unknown log type: ${e}`);t(s)}function Ze(s,e){if(s&&e){const t=Ye.repeat(s.length);return e.replace(s,t)}return e}function Xe(s){return s?typeof s=="string"?Ye.repeat(s.length):Array.isArray(s)?`[Array(${s.length})]`:Wt:s===null?"null":s?.toString()??"undefined"}function _(s,e){return new Promise((t,a)=>{const r=setTimeout(()=>{a(new Error("promise timeout"))},s);e.then(n=>{clearTimeout(r),t(n)},n=>{clearTimeout(r),a(n)})})}function Vt(){return!!(!self.window||(location.href.startsWith("safari-web-extension")||location.href.startsWith("moz-extension"))&&location.href.endsWith("generated_background_page.html"))}async function et(s){const e=await fetch(s,{method:"GET"});return e.ok?e.text():null}class Qt{events=new Map;on(e,t){const a=this.events.get(e)||[];this.events.set(e,[...a,t])}off(e,t){const a=this.events.get(e)||[];this.events.set(e,a.filter(r=>r!==t))}emit(e,...t){for(const a of this.events.get(e)||[])a(...t)}}function tt(s){const e=Object.entries(s).reduce((t,[a,r])=>(typeof r=="string"?t[a]=r:typeof r=="number"?t[a]=r.toString():(typeof r>"u"||r===null)&&(t[a]=""),t),{});return new URLSearchParams(e).toString()}async function Yt(){return(await b.runtime.getPlatformInfo()).os}async function Zt(){return(await b.windows.getCurrent()).state==="fullscreen"}function st(s){b.tabs.update(s,{active:!0})}function Xt(){return b.runtime.getManifest().version}function B(s,e){return b.i18n.getMessage(s,e)}async function P(s,e){return b.tabs.sendMessage(s,e)}function E(s){return e=>e(s)}function at(...s){b.runtime.onMessage.addListener((e,t)=>{let a=!1;for(const r of s){const n=r(g=>{if(e.type===g.type)return a=!0,g.fn(e.payload,t)});if(a)return Promise.resolve(n)}})}async function es(s){return b.runtime.sendMessage(s)}async function ts(s){return b.runtime.sendMessage(s)}(async()=>Promise.resolve().then(()=>ns))();const ss=(async()=>Promise.resolve().then(()=>vs))();class as{queue=[];isActive=!1;shouldPrint=ss.then(e=>e.getOption(e.DEBUG_LOGGING_ENABLED));push(e,t){this.queue.push({text:e,logType:t}),this.start()}async start(){if(!this.isActive){this.isActive=!0;try{for(let e=0;e<100&&this.queue.length>0;e++){const t=this.queue.shift();if(t&&await this.shouldPrint){const a=console[t.logType];if(typeof a!="function")throw new TypeError(`Unknown log type: ${t.logType}`);const r=`Web Scrobbler: ${t.text?.toString()}`;a(r)}}this.isActive=!1}catch{this.isActive=!1}}}}const rs=new as;function S(s,e="log"){rs.push(s,e)}var f=(s=>(s.RESULT_OK="ok",s.RESULT_IGNORE="ignored",s.ERROR_AUTH="error-auth",s.ERROR_OTHER="error-other",s))(f||{});function is(s,e){for(const t of s)if(t[e]===f.RESULT_IGNORE)return"ignored";for(const t of s)if(t[e]!==f.RESULT_OK)return"error";return"success"}const rt=3e3;class it{storage;namespace;requests=[];autoIncrement=0;emitter=new Qt;interval=setInterval(()=>{this.unlock()},rt);constructor(e,t){this.storage=e,this.namespace=t}unlock(){this.requests=this.requests.slice(1),this.emitter.emit("updateLock",this.requests[0]),clearInterval(this.interval),this.interval=setInterval(()=>{this.unlock()},rt)}async get(){const e=await this.storage.get();return e&&this.namespace in e?e[this.namespace]:null}async getLocking(){return await new Promise(t=>{const a=this.autoIncrement++;if(this.requests.push(a),this.requests[0]===a){t(!0);return}const r=n=>{n===a&&(t(!0),this.emitter.off("updateLock",r))};this.emitter.on("updateLock",r)}),this.get()}async set(e){const t={[this.namespace]:e};await this.storage.set(t)}async setLocking(e){try{await this.set(e)}catch(t){S(t,"warn")}this.unlock()}async update(e){const t=await this.getLocking(),a=Object.assign(t??{},e);await this.setLocking(a)}async debugLog(e=[]){const t=await this.get(),r=JSON.stringify(t,(n,g)=>e.includes(n)?Xe(g):g,2);location?.protocol==="chrome-extension:"&&S(`storage.${this.namespace} = ${r}`,"info")}async clear(){await this.storage.remove(this.namespace)}}const T=0,F=1,Ae="Connectors",ke="ConnectorsOverrideOptions",ve="customPatterns",Se="Notifications",ot="BlockedTags",nt="LocalCache",Re="NativeScrobblerNotification",Ee="Blocklists",Te="Options",te="StateManagement",se="DisabledTabs",Le="RegexEdits",ae="ScrobbleCache",xe="Core",os={[Ae]:F,[ke]:F,[ve]:F,[Se]:F,[Te]:F,LastFM:T,LibreFM:T,ListenBrainz:T,Maloja:T,Webhook:T,Pleroma:T,[Re]:T,[Ee]:T,[nt]:T,[Le]:T,[ae]:T,[ot]:T,[xe]:T,[te]:T,[se]:T};function L(s){switch(os[s]){case F:return ct(s);case T:return re(s);default:throw new Error(`Unknown storage namespace: ${s}`)}}function lt(s){return re(s)}function re(s){const e=b.storage.local;return new it(e,s)}function ct(s){const e=b.storage.sync||b.storage.local;return new it(e,s)}const ns=Object.freeze(Object.defineProperty({__proto__:null,BLOCKED_TAGS:ot,BLOCKLISTS:Ee,CONNECTORS_OPTIONS:Ae,CONNECTORS_OVERRIDE_OPTIONS:ke,CORE:xe,CUSTOM_PATTERNS:ve,DISABLED_TABS:se,LOCAL_CACHE:nt,NATIVE_SCROBBLER_NOTIFICATION:Re,NOTIFICATIONS:Se,OPTIONS:Te,REGEX_EDITS:Le,SCROBBLE_CACHE:ae,STATE_MANAGEMENT:te,getLocalStorage:re,getScrobblerStorage:lt,getStorage:L,getSyncStorage:ct},Symbol.toStringTag,{value:"Module"})),Pe=[{label:"YouTube",matches:["*://www.youtube.com/*","*://m.youtube.com/*"],js:"youtube.js",id:"youtube",usesBlocklist:!0},{label:"MySpace",matches:["*://myspace.com/*"],js:"myspace.js",id:"myspace"},{label:"Bandcamp Daily",matches:["*://daily.bandcamp.com/*"],js:"bandcamp-embed.js",id:"bandcamp-embed",allFrames:!0},{label:"Bandcamp",matches:["*://*.bandcamp.com/*","*://bandcamp.com/*"],js:"bandcamp.js",id:"bandcamp"},{label:"BNDCMPR",matches:["*://bndcmpr.co/*"],js:"bndcmpr.js",id:"bndcmpr",allFrames:!0},{label:"Buy Music Club",matches:["*://www.buymusic.club/*"],js:"buymusicclub.js",id:"buymusicclub"},{label:"Pandora",matches:["*://www.pandora.com/*"],js:"pandora.js",id:"pandora"},{label:"Pakartot",matches:["*://www.pakartot.lt/*"],js:"pakartot.js",id:"pakartot"},{label:"Deezer",matches:["*://www.deezer.com/*"],js:"deezer.js",id:"deezer"},{label:"SoundCloud",matches:["*://soundcloud.com/*","*://m.soundcloud.com/*"],js:"soundcloud.js",id:"soundcloud"},{label:"Amazon Music",matches:["*://music.amazon.*/*","*://www.amazon.*/gp/dmusic/cloudplayer/*"],js:"amazon.js",id:"amazon"},{label:"Amazon Echo",matches:["*://alexa.amazon.*/spa/*"],js:"amazon-alexa.js",id:"amazon-alexa"},{label:"Radio Vas3k Club",matches:["https://radio.vas3k.club/*"],js:"vas3kradio.js",id:"vas3kradio"},{label:"VK",matches:["*://vk.ru/*","*://vk.com/*"],js:"vk.js",id:"vk"},{label:"Megalyrics",matches:["*://megalyrics.ru/*"],js:"megalyrics.js",id:"megalyrics"},{label:"iHeartRadio",matches:["*://*.iheart.com/*"],js:"iheart.js",id:"iheart"},{label:"Indie Shuffle",matches:["*://www.indieshuffle.com/*"],js:"indieshuffle.js",id:"indieshuffle"},{label:"Tuba.FM",matches:["*://fm.tuba.pl/*"],js:"tubafm.js",id:"tubafm"},{label:"Spotify",matches:["*://open.spotify.com/*"],js:"spotify.js",id:"spotify",hasNativeScrobbler:!0},{label:"plug.dj",matches:["*://plug.dj/*"],js:"plug.dj.js",id:"plug.dj"},{label:"Dandelion Radio",matches:["*://www.dandelionradio.com/player.htm"],js:"dandelionradio.js",id:"dandelionradio"},{label:"HillyDilly",matches:["*://www.hillydilly.com/*"],js:"hillydilly.js",id:"hillydilly"},{label:"8tracks",matches:["*://8tracks.com/*"],js:"8tracks.js",id:"8tracks"},{label:"SoGreatandPowerful",matches:["*://sogreatandpowerful.com/*"],js:"sogreatandpowerful.js",id:"sogreatandpowerful"},{label:"Radio Cidade",matches:["*://radiocidade.fm/player/*","*://play.radiomania.com.br/*","*://*.melodia.com.br/*","*://jb.fm/player/*"],js:"radiocidade.js",id:"radiocidade"},{label:"Radio Nova",matches:["*://www.nova.fr/*"],js:"nova.js",id:"nova"},{label:"Radioplus",matches:["*://www.radioplus.be/*","*://radioplus.be/*"],js:"radioplus.js",id:"radioplus"},{label:"Радио Premium",matches:["*://rpfm.ru/*"],js:"rpfm.js",id:"rpfm"},{label:"Douban.FM",matches:["*://douban.fm/*","*://fm.douban.fm/*"],js:"douban.fm.js",id:"douban.fm"},{label:"Focus@Will",matches:["*://www.focusatwill.com/*"],js:"focusatwill.js",id:"focusatwill"},{label:"Subphonic (owncloud plugin)",matches:["*://*/*/apps/subphonic/minisub/*"],js:"subphonic.js",id:"subphonic"},{label:"Digitally Imported",matches:["*://www.di.fm/*"],js:"radiotunes.js",id:"di"},{label:"BBC Sounds",matches:["*://*.bbc.co.uk/*"],js:"bbc-sounds.js",id:"bbc-sounds"},{label:"Gaana",matches:["*://gaana.com/*"],js:"gaana.js",id:"gaana"},{label:"Яндекс.Музыка",matches:["*://music.yandex.ru/*","*://music.yandex.by/*","*://music.yandex.kz/*","*://music.yandex.ua/*","*://music.yandex.com/*"],js:"yandex-music.js",id:"yandex-music"},{label:"Plex",matches:["*://*32400/web/*","*://plex.tv/web/*","*://*.plex.tv/web/*","*://*.plex.tv/desktop*"],js:"plex.js",id:"plex"},{label:"TuneIn",matches:["*://tunein.com/*"],js:"tunein.js",id:"tunein"},{label:"Mixcloud",matches:["*://mixcloud.com/*","*://*.mixcloud.com/*"],js:"mixcloud.js",id:"mixcloud"},{label:"ReverbNation",matches:["*://www.reverbnation.com/*"],js:"reverbnation.js",id:"reverbnation"},{label:"NRK Radio",matches:["*://radio.nrk.no/*"],js:"nrk-radio.js",id:"nrk-radio"},{label:"Internet Archive",matches:["*://archive.org/details/*"],js:"archive.js",id:"archive"},{label:"Odnoklassniki",matches:["*://odnoklassniki.ru/*","*://ok.ru/*"],js:"odnoklassniki.js",id:"odnoklassniki"},{label:"Overcast",matches:["*://overcast.fm/*"],js:"overcast.js",id:"overcast"},{label:"Online Radio Box",matches:["*://onlineradiobox.com/*","*://p.onlineradiobox.com/*"],js:"onlineradiobox.js",id:"onlineradiobox"},{label:"163 Music",matches:["*://music.163.com/*"],js:"163-music.js",id:"163-music"},{label:"Ambient Sleeping Pill",matches:["*://ambientsleepingpill.com/"],js:"ambientsleepingpill.js",id:"ambientsleepingpill"},{label:"a.m. ambient",matches:["*://amambient.com/"],js:"ambientsleepingpill.js",id:"amambient"},{label:"Tidal",matches:["*://tidal.com/*"],js:"tidal.js",id:"tidal"},{label:"Hype Machine Featured Albums",matches:["*://hypem.com/album/*"],js:"hypem-albums.js",id:"hypem-premieres"},{label:"Hype Machine",matches:["*://hypem.com/*"],js:"hypem.js",id:"hypem"},{label:"Radionomy",matches:["*://www.radionomy.com/*"],js:"radionomy.js",id:"radionomy"},{label:"J1 Radio",matches:["*://www.j1fm.tokyo/player/*","*://www.j1fm.tokyo/michi/player/*"],js:"aiircom.js",id:"j1-radio"},{label:"JazzAndRain",matches:["*://*.jazzandrain.com/*"],js:"jazzandrain.js",id:"jazzandrain"},{label:"RelaxingBeats",matches:["*://*.relaxingbeats.com/*"],js:"jazzandrain.js",id:"relaxingbeats"},{label:"EpicMusicTime",matches:["*://*.epicmusictime.com/*"],js:"jazzandrain.js",id:"epicmusictime"},{label:"AccuJazz",matches:["*://www.accuradio.com/pop_player/accujazz/*"],js:"accujazz.js",id:"accujazz"},{label:"AccuRadio",matches:["*://www.accuradio.com/*"],js:"accuradio.js",id:"accuradio"},{label:"Imusic.am",matches:["*://imusic.am/*"],js:"imusic.am.js",id:"imusic.am"},{label:"Earbits",matches:["*://www.earbits.com/*"],js:"earbits.js",id:"earbits"},{label:"Player.fm",matches:["*://player.fm/*"],js:"player.fm.js",id:"player.fm"},{label:"Sound Test",matches:["*://sndtst.com/*"],js:"sndtst.js",id:"sndtst"},{label:"RadioTunes",matches:["*://www.radiotunes.com/*"],js:"radiotunes.js",id:"radiotunes"},{label:"RockRadio",matches:["*://www.rockradio.com/*"],js:"radiotunes.js",id:"rockradio"},{label:"ClassicalRadio",matches:["*://www.classicalradio.com/*"],js:"radiotunes.js",id:"classicalradio"},{label:"Audacy",matches:["*://www.audacy.com/*"],js:"audacy.js",id:"audacy"},{label:"Audius",matches:["*://audius.co/*"],js:"audius.js",id:"audius"},{label:"GetWorkDoneMusic",matches:["*://*.getworkdonemusic.com/*"],js:"getworkdonemusic.js",id:"getworkdonemusic"},{label:"Jamendo",matches:["*://www.jamendo.com/*"],js:"jamendo.js",id:"jamendo"},{label:"Bandzone.cz",matches:["*://bandzone.cz/*"],js:"bandzone.cz.js",id:"bandzone.cz"},{label:"Music Player for Google Drive",matches:["*://www.driveplayer.com/*"],js:"driveplayer.js",id:"driveplayer"},{label:"Kodi",js:"kodi.js",id:"kodi"},{label:"Superplayer",matches:["*://www.superplayer.fm/*"],js:"superplayer.js",id:"superplayer"},{label:"RMFON",matches:["*://www.rmfon.pl/*"],js:"rmfon.js",id:"rmfon"},{label:"Radio 357",matches:["*://radio357.pl/*"],js:"radio357.js",id:"radio357"},{label:"JazzRadio",matches:["*://www.jazzradio.com/*"],js:"radiotunes.js",id:"jazzradio"},{label:"Zen Radio",matches:["*://www.zenradio.com/*"],js:"radiotunes.js",id:"zenradio"},{label:"SomaFM",matches:["*://somafm.com/player/*","*://somafm.com/player24/*"],js:"somafm.js",id:"somafm"},{label:"Free Music Archive",matches:["*://*.freemusicarchive.org/*"],js:"freemusicarchive.js",id:"freemusicarchive"},{label:"Reddit Music Player",matches:["*://reddit.musicplayer.io/"],js:"redditmusicplayer.js",id:"redditmusicplayer"},{label:"Новое Радио",matches:["*://www.novoeradio.by/*"],js:"novoeradio.js",id:"novoeradio"},{label:"Radio Paradise",matches:["*://radioparadise.com/*"],js:"radioparadise.js",id:"radioparadise",allFrames:!0},{label:"Beatport",matches:["*://www.beatport.com/*"],js:"beatport.js",id:"beatport"},{label:"Beeline Music",matches:["*://music.beeline.ru/*"],js:"beeline-music.js",id:"beeline-music"},{label:"wavo",matches:["*://wavo.me/*"],js:"wavo.js",id:"wavo"},{label:"FluxFM Berlin",matches:["*://www.fluxfm.de/*"],js:"fluxfm.js",id:"fluxfm"},{label:"Noise FM",matches:["*://noisefm.ru/*","*://en.noisefm.ru/*"],js:"noisefm.js",id:"noisefm",allFrames:!0},{label:"WWOZ",matches:["*://www.wwoz.org/listen/player/*"],js:"wwoz.js",id:"wwoz"},{label:"Sonerezh",matches:["*://sonerezh.*/*","*://*/*sonerezh*"],js:"sonerezh.js",id:"sonerezh"},{label:"Youradio",matches:["*://www.youradio.cz/*"],js:"youradio.js",id:"youradio"},{label:"GPMusic",matches:["*://player.gpmusic.co/*"],js:"gpmusic.js",id:"gpmusic"},{label:"Nightwave Plaza",matches:["*://plaza.one/*"],js:"plaza.js",id:"plaza"},{label:"Retrowave",matches:["*://retrowave.ru/*"],js:"retrowave.js",id:"retrowave"},{label:"Genie",matches:["*://www.genie.co.kr/player/fPlayer*"],js:"genie.js",id:"genie"},{label:"Bugs",matches:["*://music.bugs.co.kr/newPlayer*"],js:"bugs.js",id:"bugs"},{label:"openfm",matches:["*://open.fm/*"],js:"openfm.js",id:"openfm"},{label:"Playmoss",matches:["*://playmoss.com/*"],js:"playmoss.js",id:"playmoss"},{label:"Apidog",matches:["*://apidog.ru/*"],js:"apidog.js",id:"apidog"},{label:"Pinguin Radio",matches:["*://pinguinradio.com/*"],js:"pinguinradio.js",id:"pinguinradio"},{label:"JioSaavn",matches:["*://www.jiosaavn.com/*"],js:"jiosaavn.js",id:"jiosaavn"},{label:"Anghami",matches:["*://*.anghami.com/*"],js:"anghami.js",id:"anghami"},{label:"Mail.ru Music",matches:["*://my.mail.ru/music","*://my.mail.ru/music/*"],js:"mail.ru.js",id:"mail.ru"},{label:"Emby/Jellyfin",matches:["*://*8096/web/*","*://*8920/web/*","*://app.emby.media/*"],js:"emby.js",id:"emby"},{label:"Freegal Music",matches:["*://*.freegalmusic.com/*"],js:"freegalmusic.js",id:"freegalmusic"},{label:"hoopla",matches:["*://www.hoopladigital.com/*"],js:"hoopladigital.js",id:"hoopladigital"},{label:"Amplify 817",matches:["*://amplify817.org/*"],js:"musicat.js",id:"amplify817"},{label:"Capital City Records",matches:["*://capitalcityrecords.ca/*"],js:"musicat.js",id:"capitalcityrecords"},{label:"Electric Lady Bird",matches:["*://atxlibrary.musicat.co/*"],js:"musicat.js",id:"musicat-atxlibrary"},{label:"FlipSide",matches:["*://flipside.apl.org/*"],js:"musicat.js",id:"apl-flipside"},{label:"HUM (Hear Utah Music)",matches:["*://hum.slcpl.org/*"],js:"musicat.js",id:"slcpl-hum"},{label:"KDL Vibes",matches:["*://vibes.kdl.org/*"],js:"musicat.js",id:"kdl-vibes"},{label:"Library Music Project",matches:["*://librarymusicproject.com/*"],js:"musicat.js",id:"librarymusicproject"},{label:"MNspin",matches:["*://hclib.musicat.co/*"],js:"musicat.js",id:"musicat-hclib"},{label:"Nashville BoomBox",matches:["*://boombox.library.nashville.org/*"],js:"musicat.js",id:"nashville-library-boombox"},{label:"QC Beats",matches:["*://qcbeats.org/*"],js:"musicat.js",id:"qcbeats"},{label:"Q-Dance",matches:["*://www.q-dance.com/*"],js:"q-dance.js",id:"q-dance"},{label:"Sawdust City Sounds",matches:["*://sawdustcitysounds.org/*"],js:"musicat.js",id:"sawdustcitysounds"},{label:"Seattle PlayBack",matches:["*://playback.spl.org/*"],js:"musicat.js",id:"spl-playback"},{label:"STACKS",matches:["*://stacks.carnegielibrary.org/*"],js:"musicat.js",id:"carnegielibrary-stacks"},{label:"Tracks Music Library",matches:["*://tracksmusiclibrary.org/*"],js:"musicat.js",id:"tracksmusiclibrary"},{label:"Monstercat",matches:["*://www.monstercat.com/*"],js:"monstercat.js",id:"monstercat"},{label:"Listen.moe",matches:["*://listen.moe/*"],js:"listen.moe.js",id:"listen.moe"},{label:"anime(bits)",matches:["*://radio.animebits.moe/","*://radio.animebits.moe/player/*"],js:"animebits.js",id:"animebits"},{label:"Fair Price Music",matches:["*://www.fairpricemusic.com/*"],js:"fairpricemusic.js",id:"fairpricemusic"},{label:"Radio ULTRA",matches:["*://player.radioultra.ru/*"],js:"radioultra.js",id:"radioultra"},{label:"Наше Радио",matches:["*://player.nashe.ru/*"],js:"radioultra.js",id:"nashe"},{label:"RockFM",matches:["*://player.rockfm.ru/*"],js:"radioultra.js",id:"rockfm"},{label:"Radio JAZZ",matches:["*://player.radiojazzfm.ru/*"],js:"radioultra.js",id:"radiojazzfm"},{label:"WO Streaming",matches:["*://*player.wostreaming.net/*"],js:"wostreaming.js",id:"wostreaming"},{label:"Listen Live",matches:["*://player.listenlive.co/*"],js:"listenlive.js",id:"listenlive"},{label:"Rayo",matches:["*://hellorayo.co.uk/*/play/*","*://hellorayo.co.uk/*/player/*"],js:"planetradio.js",id:"planetradio"},{label:"Roxx Radio",matches:["*://roxx.gr/radio/*"],js:"roxx.js",id:"roxx"},{label:"ListenOnRepeat",matches:["*://listenonrepeat.com/*"],js:"listenonrepeat.js",id:"listenonrepeat"},{label:"Duckburg Radio",matches:["*://*.radio-mb.com/*"],js:"radio-mb.js",id:"radio-mb"},{label:"Webradio.de",matches:["*://www.webradio.de/*"],js:"radioplayer.js",id:"webradio.de"},{label:"The Breeze",matches:["*://www.thebreeze.com/*/radioplayer/*"],js:"radioplayer.js",id:"thebreeze"},{label:"RadioPlayer",matches:["*://ukradioplayer.*/*","*://radioplayer.*/*","*://*/radioplayer/*","*://*/radio/player/","*://*/*/radio/player/"],js:"radioplayer.js",id:"radioplayer"},{label:"deltaradio",matches:["*://www.deltaradio.de/*"],js:"deltaradio.de.js",id:"deltaradio.de"},{label:"Radio Bob",matches:["*://*.radiobob.de/*"],js:"radiobob.js",id:"radiobob"},{label:"ByteFM",matches:["*://www.byte.fm/*"],js:"byte.fm.js",id:"byte.fm"},{label:"Deutschlandfunk Nova",matches:["*://www.deutschlandfunknova.de/*"],js:"deutschlandfunknova.js",id:"deutschlandfunknova"},{label:"QQ Music",matches:["*://y.qq.com/*"],js:"qq-music.js",id:"qq-music"},{label:"QQ Video",matches:["*://v.qq.com/x/*"],js:"qq-video.js",id:"qq-video"},{label:"Naver",matches:["*://playerui.music.naver.com/*"],js:"naver.js",id:"naver"},{label:"Soribada",matches:["*://www.soribada.com/*"],js:"soribada.js",id:"soribada"},{label:"Flo",matches:["*://www.music-flo.com/*"],js:"music-flo.js",id:"music-flo"},{label:"Discogs",matches:["*://www.discogs.com/*"],js:"youtube-embed.js",id:"youtube-embed",allFrames:!0},{label:"NPR",matches:["*://www.npr.org/*"],js:"npr.js",id:"npr"},{label:"Streamsquid",matches:["*://streamsquid.com/*"],js:"streamsquid.js",id:"streamsquid"},{label:"Streemlion",matches:["*://listen.streemlion.com/*"],js:"streemlion.js",id:"streemlion"},{label:"eMusic",matches:["*://www.emusic.com/*"],js:"emusic.js",id:"emusic"},{label:"LyricsTraining",matches:["*://lyricstraining.com/*"],js:"lyricstraining.js",id:"lyricstraining"},{label:"Music Walker",matches:["*://arkanath.com/MusicWalker/*"],js:"musicwalker.js",id:"musicwalker"},{label:"radioeins",matches:["*://www.radioeins.de/livestream/*"],js:"radioeins.js",id:"radioeins"},{label:"Fritz",matches:["*://www.fritz.de/livestream/*"],js:"fritz.js",id:"fritz"},{label:"Musicoin",matches:["*://musicoin.org/*"],js:"musicoin.js",id:"musicoin"},{label:"181.fm",matches:["*://player.181fm.com/*"],js:"181.fm.js",id:"181.fm"},{label:"Phish.in",matches:["*://phish.in/*"],js:"phish.in.js",id:"phish.in"},{label:"Rainwave",matches:["*://rainwave.cc/*","*://all.rainwave.cc/*","*://game.rainwave.cc/*","*://chiptune.rainwave.cc/*","*://ocr.rainwave.cc/*","*://covers.rainwave.cc/*"],js:"rainwave.js",id:"rainwave"},{label:"Retro Synthwave",matches:["*://www.retro-synthwave.com/*"],js:"retro-synthwave.js",id:"retro-synthwave"},{label:"Радиоволна.нет",matches:["*://radiovolna.net/*"],js:"radiovolna.js",id:"radiovolna"},{label:"Feedbands",matches:["*://feedbands.com/*"],js:"feedbands.js",id:"feedbands"},{label:"Taazi",matches:["*://taazi.com/*"],js:"taazi.js",id:"taazi"},{label:"Patari",matches:["*://patari.pk/*"],js:"patari.js",id:"patari"},{label:"pCloud",matches:["*://my.pcloud.com/*"],js:"pcloud.js",id:"pcloud"},{label:"JetSetRadio Live",matches:["*://jetsetradio.live/*"],js:"jetsetradio.live.js",id:"jetsetradio.live"},{label:"Radio France",matches:["*://www.radiofrance.fr/*"],js:"radiofrance.js",id:"radiofrance"},{label:"RemixRotation",matches:["*://remixrotation.com/*"],js:"remixrotation.js",id:"remixrotation"},{label:"WFMU",matches:["*://wfmu.org/*","*://freeform.wfmu.org/*"],js:"wfmu.js",id:"wfmu"},{label:"SiriusXM",matches:["*://www.siriusxm.com/*","*://www.siriusxm.ca/*","*://*.siriusxm.com/player/*"],js:"siriusxm-player.js",id:"siriusxm-player"},{label:"1ting",matches:["*://www.1ting.com/player/*","*://www.1ting.com/p_*","*://www.1ting.com/album*","*://www.1ting.com/rand.php*","*://www.1ting.com/day/*","*://h5.1ting.com/*"],js:"1ting.js",id:"1ting"},{label:"Douban Artists",matches:["*://music.douban.com/artists/player/*"],js:"douban-artists.js",id:"douban-artists"},{label:"Kugou",matches:["*://www.kugou.com/song/*"],js:"kugou.js",id:"kugou"},{label:"Gimme Radio",matches:["*://gimmeradio.com/*","*://www.gimmeradio.com/*","*://gimmecountry.com/*","*://www.gimmecountry.com/*","*://gimmemetal.com/*","*://www.gimmemetal.com/*"],js:"gimmeradio.js",id:"gimmeradio"},{label:"9sky",matches:["*://www.9sky.com/music*","*://www.9sky.com/mv/detail*"],js:"9sky.js",id:"9sky"},{label:"Vagalume.FM",matches:["*://vagalume.fm/*","*://*.vagalume.com.br/*"],js:"vagalume.js",id:"vagalume"},{label:"Radiooooo",matches:["*://radiooooo.com/*","*://mobile.radiooooo.com/*"],js:"radiooooo.js",id:"radiooooo"},{label:"LetsLoop",matches:["*://letsloop.com/*"],js:"letsloop.js",id:"letsloop"},{label:"Mideast Tunes",matches:["*://mideastunes.com/*","*://map.mideastunes.com/*"],js:"mideastunes.js",id:"mideastunes"},{label:"Český Rozhlas",matches:["*://prehravac.rozhlas.cz/*"],js:"rozhlas.js",id:"rozhlas"},{label:"blocSonic",matches:["*://*.blocsonic.com/*"],js:"blocsonic.js",id:"blocsonic"},{label:"Resonate",matches:["*://stream.resonate.coop/*"],js:"resonate.js",id:"resonate"},{label:"KEXP",matches:["*://*.kexp.org/*"],js:"kexp.js",id:"kexp"},{label:"Hotmixradio.fr",matches:["*://www.hotmixradio.fr/*"],js:"hotmixradio.js",id:"hotmixradio"},{label:"Aphex Twin",matches:["*://aphextwin.warp.net/*"],js:"warp-aphextwin.js",id:"warp-aphextwin"},{label:"Zachary Seguin Music",matches:["*://music.zacharyseguin.ca/*"],js:"musickit.js",id:"zacharyseguin"},{label:"Joox",matches:["*://www.joox.com/*"],js:"joox.js",id:"joox"},{label:"Musish",matches:["*://musi.sh/*"],js:"musickit.js",id:"musish"},{label:"1001tracklists",matches:["*://www.1001tracklists.com/tracklist/*"],js:"1001tracklists.js",id:"1001tracklists"},{label:"YouTube Music",matches:["*://music.youtube.com/*"],js:"youtube-music.js",id:"youtube-music"},{label:"Radiozenders.FM",matches:["*://www.radiozenders.fm/*"],js:"radiozenders.js",id:"radiozenders"},{label:"Invidious",matches:["*://*.invidio.us/*"],js:"invidious.js",id:"invidious"},{label:"Piped",matches:["*://piped.video/*"],js:"piped.js",id:"piped"},{label:"Pretzel",matches:["*://*.pretzel.rocks/*"],js:"pretzel.js",id:"pretzel"},{label:"Primordial Radio",matches:["*://primordialradio.com/*"],js:"primordialradio.js",id:"primordialradio"},{label:"Radio Kyivstar",matches:["*://radio.kyivstar.ua/*"],js:"kyivstar.js",id:"kyivstar"},{label:"Funkwhale",js:"funkwhale.js",id:"funkwhale"},{label:"9128.live",matches:["*://9128.live/*","*://embed.radio.co/player/*"],js:"radioco.js",id:"9128.live",allFrames:!0},{label:"Radio.co",matches:["*://embed.radio.co/player/*"],js:"radioco.js",id:"radioco"},{label:"Super45.fm",matches:["*://super45.fm/"],js:"radioco.js",id:"super45fm",allFrames:!0},{label:"R/a/dio",matches:["*://r-a-d.io/*"],js:"r-a-d.io.js",id:"r-a-d.io"},{label:"Apple Music",matches:["*://*music.apple.com/*"],js:"musickit.js",id:"apple-music"},{label:"Primephonic",matches:["*://play.primephonic.com/*"],js:"primephonic.js",id:"primephonic"},{label:"Watch2Gether",matches:["*://w2g.tv/*"],js:"watch2gether.js",id:"watch2gether"},{label:"Poolsuite",matches:["*://poolsuite.net/*"],js:"poolsuite.js",id:"poolsuite"},{label:"GDS.FM",matches:["*://www.gds.fm/*","*://gds.fm/*"],js:"gds.fm.js",id:"gds"},{label:"Wynk Music",matches:["*://wynk.in/music*"],js:"wynk.js",id:"wynk"},{label:"RadioJavan",matches:["*://play.radiojavan.com/*"],js:"radiojavan.js",id:"radiojavan"},{label:"Audiomack",matches:["*://audiomack.com/*"],js:"audiomack.js",id:"audiomack"},{label:"Global Player",matches:["*://www.globalplayer.com/*"],js:"globalplayer.js",id:"globalplayer"},{label:"The Current",matches:["*://www.thecurrent.org/*"],js:"thecurrent.js",id:"thecurrent"},{label:"pan y rosas discos",matches:["*://www.panyrosasdiscos.net/*"],js:"panyrosasdiscos.js",id:"panyrosasdiscos"},{label:"GRRIF",matches:["*://*.grrif.ch/*"],js:"grrif.js",id:"grrif"},{label:"newgrounds",matches:["*://www.newgrounds.com/audio*"],js:"newgrounds.js",id:"newgrounds"},{label:"Jango",matches:["*://www.jango.com/*"],js:"jango.js",id:"jango"},{label:"PlayIrish",matches:["*://*.playirish.ie/*"],js:"playirish.js",id:"playirish"},{label:"Radio Record",matches:["*://www.radiorecord.ru/*"],js:"radiorecord.js",id:"radiorecord"},{label:"Imago Radio",matches:["*://*.imago.fm/*"],js:"imago.js",id:"imago"},{label:"Provoda.ch",matches:["*://*.provoda.ch/*"],js:"provoda.ch.js",id:"provoda.ch"},{label:"Atomic Music Space",matches:["*://stream.atomicmusic.space/*"],js:"atomicmusic.space.js",id:"atomicmusic.space"},{label:"The-radio.ru",matches:["*://the-radio.ru/*"],js:"the-radio.ru.js",id:"the-radio.ru"},{label:"HQ Radio",matches:["*://hqradio.ru/*"],js:"hqradio.js",id:"hqradio"},{label:"Smooth FM",matches:["*://smoothfm.iol.pt/*"],js:"smoothfm.js",id:"smoothfm"},{label:"Vodafone.fm",matches:["*://vodafone.fm/*"],js:"vodafone.fm.js",id:"vodafonefm"},{label:"Relisten.net",matches:["*://relisten.net/*"],js:"relisten.js",id:"relisten"},{label:"UpBeatRadio",matches:["*://upbeatradio.net/*"],js:"upbeatradio.js",id:"upbeatradio"},{label:"Chillhop",matches:["*://chillhop.com/*"],js:"chillhop.js",id:"chillhop"},{label:"DatPiff",matches:["*://www.datpiff.com/player/*"],js:"datpiff.js",id:"datpiff",allFrames:!0},{label:"Shuffle",matches:["*://shuffle.one/play*"],js:"shuffleone.js",id:"shuffleone"},{label:"JB FM",matches:["*://jb.fm/player/*"],js:"jb.fm.js",id:"jbfm"},{label:"SECTOR Radio",matches:["*://sectorradio.ru/*"],js:"sectorradio.js",id:"sectorradio"},{label:"LiveOne",matches:["*://*.liveone.com/*"],js:"liveone.js",id:"liveone"},{label:"PocketCasts",matches:["*://play.pocketcasts.com/*"],js:"pocketcasts.js",id:"pocketcasts"},{label:"Clyp",matches:["*://clyp.it/*"],js:"clyp.js",id:"clyp"},{label:"RTBF Radio",matches:["*://www.rtbf.be/radio/*"],js:"rtbf.js",id:"rtbf"},{label:"TuneTrack",matches:["*://tunetrack.net/*"],js:"tunetrack.js",id:"tunetrack"},{label:"Musify",matches:["*://*.musify.club/*"],js:"musify.js",id:"musify"},{label:"Radio Rethink",matches:["*://www.radiorethink.com/*"],js:"radiorethink.js",id:"radiorethink"},{label:"SoundClick",matches:["*://www.soundclick.com/*"],js:"soundclick.js",id:"soundclick"},{label:"Napster",matches:["*://app.napster.com/*"],js:"napster.js",id:"napster"},{label:"abc.net.au",matches:["*://www.abc.net.au/*/listen-live/*"],js:"abc.net.au.js",id:"abcnetau"},{label:"JQBX",matches:["*://app.jqbx.fm/*"],js:"jqbx.js",id:"jqbx"},{label:"music.jsososo.com",matches:["*://y.jsososo.com/*","*://music.jsososo.com/*"],js:"jsososo.js",id:"jsososo"},{label:"Supla",matches:["*://*.supla.fi/*"],js:"supla.js",id:"supla"},{label:"swr3",matches:["*://www.swr3.de/*"],js:"swr3.js",id:"swr3"},{label:"Epidemic Sound",matches:["*://*.epidemicsound.com/*"],js:"epidemicsound.js",id:"epidemicsound"},{label:"Rekt Network",matches:["*://rekt.network/*"],js:"rekt.network.js",id:"rektnetwork"},{label:"Nightride FM",matches:["*://nightride.fm/*"],js:"nightride.fm.js",id:"nightridefm"},{label:"Qobuz",matches:["*://*.qobuz.com/*"],js:"qobuz.js",id:"qobuz"},{label:"TruckersFM",matches:["*://*.truckers.fm/*"],js:"truckersfm.js",id:"truckersfm"},{id:"winampify",label:"Winampify",js:"winampify.js",matches:["*://winampify.io/*"]},{label:"detektor.fm",matches:["*://detektor.fm/*"],js:"detektorfm.js",id:"detektorfm"},{label:"iBroadcast",matches:["*://media.ibroadcast.com/*"],js:"ibroadcast.js",id:"ibroadcast"},{label:"Radio7",matches:["*://radio7.lv/*"],js:"radio7.js",id:"radio7lv"},{label:"TOWER RECORDS MUSIC",matches:["*://music.tower.jp/*"],js:"towerrecordsmusic.js",id:"towerrecordsmusic"},{label:"Eggs",matches:["*://eggs.mu/*"],js:"eggs.js",id:"eggs"},{label:"Jamstash",matches:["*://jamstash.com/*"],js:"jamstash.js",id:"jamstash"},{label:"SubFire",matches:["*://p.subfireplayer.net/*"],js:"subfire.js",id:"subfire"},{label:"Idagio",matches:["*://app.idagio.com/*"],js:"idagio.js",id:"idagio"},{label:"Relax FM",matches:["*://relax-fm.ru/*"],js:"relaxfm.js",id:"relaxfm"},{label:"Laut.fm",matches:["*://laut.fm/*"],js:"laut.fm.js",id:"laut.fm"},{label:"Magnatune",matches:["*://magnatune.com/*"],js:"magnatune.js",id:"magnatune"},{label:"Libre.fm",matches:["*://libre.fm/*"],js:"librefm.js",id:"librefm"},{label:"Brain.fm",matches:["*://my.brain.fm/*"],js:"brainfm.js",id:"brainfm"},{label:"bullofheaven.com",matches:["*://bullofheaven.com/*"],js:"bullofheaven.com.js",id:"bullofheavencom"},{label:"All Classical Portland",matches:["*://player.allclassical.org/*"],js:"allclassical.org.js",id:"allclassicalportland"},{label:"Migu Music",matches:["*://music.migu.cn/*"],js:"migu-music.js",id:"migu-music"},{label:"Weibo",matches:["*://weibo.com/*","*://*.weibo.com/*"],js:"weibo.js",id:"weibo"},{label:"Street Voice",matches:["*://streetvoice.cn/*","*://streetvoice.com/*"],js:"streetvoice.js",id:"streetvoice"},{label:"Red Bull",matches:["*://www.redbull.com/*"],js:"redbull.js",id:"redbull"},{label:"Synology",matches:["*://*5000/*","*://*5001/*","*://*/?launchApp=SYNO.SDS.AudioStation.Application*"],js:"synology.js",id:"synology"},{label:"Ragya",matches:["*://www.ragya.com/*"],js:"ragya.js",id:"ragya"},{label:"CodeRadio",matches:["*://coderadio.freecodecamp.org/*"],js:"coderadio.js",id:"coderadio"},{label:"LITT Live",matches:["*://littlive.com/*"],js:"littlive.js",id:"dashradio"},{label:"Niconico",matches:["*://www.nicovideo.jp/*"],js:"nicovideo.js",id:"nicovideo"},{label:"Звук",matches:["*://zvuk.com/*"],js:"zvuk.js",id:"zvuk"},{label:"Navidrome",js:"navidrome.js",id:"navidrome"},{label:"LMS",js:"lms.js",id:"lms"},{label:"deep-cut.fm",matches:["*://deepcut.fm/*","*://turntable.fm/*","*://deep-cut.fm/*","*://deepcuts.fm/*"],js:"deep-cut.fm.js",id:"deepcut.fm"},{label:"Burntable",matches:["*://*.burntable.com/*"],js:"burntable.js",id:"burntable"},{label:"Stingray Music",matches:["*://*.stingray.com/*"],js:"stingray.js",id:"stingray"},{label:"CBC Music",matches:["*://www.cbc.ca/listen/cbc-music-playlists*"],js:"cbcmusic.js",id:"cbcmusic"},{label:"Indie88",matches:["*://indie88.com/lean-stream-player/*","*://cob.leanplayer.com/CINDFM*"],js:"indie88.js",id:"indie88"},{label:"Playlist Randomizer",matches:["*://www.playlist-randomizer.com/*","*://playlist-randomizer.com/*"],js:"playlist-randomizer.js",id:"playlist-randomizer"},{label:"QueUp",matches:["*://www.queup.net/*"],js:"queup.js",id:"queup"},{label:"Live 365",matches:["*://*.live365.com/*"],js:"live365.js",id:"live365"},{label:"Lounge.fm",matches:["*://www.lounge.fm/*"],js:"lounge.fm.js",id:"lounge.fm"},{label:"EulerBeats",matches:["*://eulerbeats.com/*"],js:"eulerbeats.js",id:"eulerbeats"},{label:"FilmMusic.io",matches:["*://*.filmmusic.io/*"],js:"filmmusic.io.js",id:"filmmusic.io"},{label:"X-Team Radio",matches:["*://radio.x-team.com/*"],js:"xteam-radio.js",id:"xteam-radio"},{label:"Calm",matches:["*://*.calm.com/*"],js:"calm.js",id:"calm"},{label:"Keakie",matches:["*://*.keakie.com/*"],js:"keakie.js",id:"keakie"},{label:"KKBOX",matches:["*://*play.kkbox.com/*"],js:"kkbox.js",id:"kkbox"},{label:"Thrill Jockey",matches:["*://thrilljockey.com/products/*"],js:"thrilljockey.js",id:"thrilljockey"},{label:"Radio Horizonte",matches:["*://horizonte.cl/*"],js:"mediastream.js",id:"horizontecl"},{label:"Sonar FM",matches:["*://sonarfm.cl/*"],js:"mediastream.js",id:"sonarfmcl"},{label:"Play FM",matches:["*://playfm.cl/*"],js:"mediastream.js",id:"playfmcl"},{label:"WKM Radio",matches:["*://www.wkmradio.com/*"],js:"mediastream.js",id:"wkmradio"},{label:"Rockaxis",matches:["*://www.rockaxis.com/*"],js:"mediastream.js",id:"rockaxis"},{label:"Rock&Pop Chile",matches:["*://www.rockandpop.cl/*"],js:"rockandpopcl.js",id:"rockandpopcl"},{label:"WYEP",matches:["*://wyep.org/*"],js:"wyep.js",id:"wyep"},{label:"ZENO",matches:["*://*zeno.fm/*"],js:"zeno.js",id:"zeno"},{label:"Naxos Music Library",matches:["*://*.naxosmusiclibrary.com/*"],js:"naxosmusiclibrary.js",id:"naxosmusiclibrary"},{label:"Klassik Radio",matches:["*://*klassikradio.de/*"],js:"klassikradio.de.js",id:"klassikradio"},{label:"Beetle",js:"beetle.js",id:"beetle"},{label:"RefNet",matches:["*://listen.refnet.fm/*"],js:"refnet.js",id:"refnet"},{label:"La Radio du bord de l'eau",matches:["*://*auborddeleau.radio/*"],js:"auborddeleau.radio.js",id:"auborddeleau.radio",allFrames:!0},{label:"Radio Willy",matches:["*://*willy.radio/player/willy/*"],js:"willy.radio.js",id:"willy.radio"},{label:"NIGHT.FM",matches:["*://*night.fm/*"],js:"night.fm.js",id:"night.fm"},{label:"Radio Nowy Swiat",matches:["*://nowyswiat.online/*"],js:"nowyswiat.js",id:"nowyswiat"},{label:"Radiolla",matches:["*://*radiolla.com/*"],js:"radiolla.js",id:"radiolla"},{label:"Oxigenio.fm",matches:["*://*oxigenio.fm/*"],js:"oxigenio.fm.js",id:"oxigenio.fm"},{label:"Intergalactic FM",matches:["*://*intergalactic.fm/*"],js:"intergalacticfm.js",id:"intergalactic.fm"},{label:"Radio Cuca",matches:["*://*radiocuca.es/*"],js:"radiocuca.js",id:"radiocuca"},{label:"Irama Nusantara",matches:["*://*.iramanusantara.org/*"],js:"iramanusantara.js",id:"iramanusantara"},{label:"Yammat FM",matches:["*://*yammat.fm/*"],js:"yammat.fm.js",id:"yammat.fm"},{label:"Husk Recordings",matches:["*://huskrecordings.com/music/*"],js:"huskrecordings.js",id:"huskrecordings"},{label:"nugs.net",matches:["*://play.nugs.net/*"],js:"nugs.js",id:"nugs"},{label:"livephish.com",matches:["*://plus.livephish.com/*"],js:"livephish.js",id:"livephish.com"},{label:"Ishkur's Guide to Electronic Music",matches:["*://music.ishkur.com/*"],js:"ishkur.js",id:"music.ishkur.com"},{label:"Nonoki",matches:["*://nonoki.com/music/*"],js:"nonoki.js",id:"nonoki"},{label:"Beatbump",matches:["*://beatbump.io/*"],js:"beatbump.js",id:"beatbump"},{label:"LINE MUSIC",matches:["*://music.line.me/*"],js:"line-music.js",id:"linemusic"},{label:"KCRW",matches:["*://www.kcrw.com/*"],js:"kcrw.js",id:"kcrw"},{label:"World Fusion Radio",matches:["*://worldfusionradio.com/*"],js:"worldfusionradio.js",id:"worldfusionradio"},{label:"Hardtunes",matches:["*://www.hard-tunes.de/*","*://www.hardtunes.com/*","*://www.hardtunes.fr/*","*://www.hardtunes.it/*","*://www.hardtunes.nl/*"],js:"hardtunes.js",id:"hardtunes"},{label:"KINK",matches:["*://kink.nl/player","*://kink.nl/player/*"],js:"kinknl.js",id:"kinknl"},{label:"The Jazz Groove",matches:["*://jazzgroove.org/*"],js:"jazzgroove.js",id:"jazzgroove"},{label:"XRAY.FM",matches:["*://*.xray.fm/*"],js:"xrayfm.js",id:"xrayfm"},{label:"DKFM Shoegaze Radio",matches:["*://decayfm.com/*"],js:"decayfm.js",id:"decayfm"},{label:"QCIndie",matches:["*://www.qcindie.com/listen-live/*"],js:"qcindie.js",id:"qcindie"},{label:"Colorado Public Radio",matches:["*://www.cpr.org/*"],js:"cpr.js",id:"cpr"},{label:"Indie 102.3",matches:["*://indie.cpr.org/"],js:"cpr-indie.js",id:"cpr-indie"},{label:"WXPN",matches:["*://xpn.org/*"],js:"xpn.js",id:"xpn"},{label:"FRISKY",matches:["*://*.frisky.fm/*"],js:"friskyfm.js",id:"friskyfm"},{label:"GotRadio",matches:["*://player.gotradio.com/*"],js:"gotradio.js",id:"gotradio"},{label:"LightningStream",matches:["*://*.lightningstream.com/Player*","*://*.lightningstream.com/player*"],js:"lightningstream.js",id:"lightningstream"},{label:"Securenet Systems",matches:["*://radio.securenetsystems.net/*","*://stream*.securenetsystems.net/*"],js:"securenetsystems.js",id:"securenetsystems"},{label:"WBRU",matches:["*://www.wbru.com/*"],js:"radioco.js",id:"wbru",allFrames:!0},{label:"uwu radio",matches:["*://radio.uwu.network/*"],js:"uwu-radio.js",id:"uwu-radio"},{label:"MyStreamPlayer",matches:["*://*.mystreamplayer.com/*"],js:"mystreamplayer.js",id:"mystreamplayer"},{label:"BagelRadio",matches:["*://*.bagelradio.com/*"],js:"mystreamplayer.js",id:"bagelradio",allFrames:!0},{label:"Amazing Radio",matches:["*://amazingradio.com/*","*://amazingradio.us/*"],js:"amazingradio.js",id:"amazingradio"},{label:"DR Lyd",matches:["*://www.dr.dk/lyd*"],js:"dr-lyd.js",id:"dr-lyd"},{label:"lulu.fm",matches:["*://*lulu.fm/*"],js:"lulu.fm.js",id:"lulufm"},{label:"ROCK ANTENNE",matches:["*://*rockantenne.*/webradio/*"],js:"rockantenne.js",id:"rockantenne"},{label:"copyparty",matches:["*://127.0.0.1:3923/*","*://a.ocv.me/*"],js:"copyparty.js",id:"copyparty"},{label:"Fungjai",matches:["*://*.fungjai.com/*"],js:"fungjai.js",id:"fungjai"},{label:"Radio Caprice",matches:["*://radcap.ru/*"],js:"radcap.js",id:"radcap"},{label:"TrackerHub",matches:["*://trackerhub.vercel.app/*","*://trackerhub.cx/*"],js:"trackerhub.js",id:"trackerhub"},{label:"Gensokyo Radio",matches:["*://gensokyoradio.net/*"],js:"gensokyoradio.js",id:"gensokyoradio"},{label:"Stationhead",matches:["*://*stationhead.com/*"],js:"stationhead.js",id:"stationhead"},{label:"TECHNOBASE.FM",matches:["*://*technobase.fm/*","*://*housetime.fm/*","*://*hardbase.fm/*","*://*trancebase.fm/*","*://*coretime.fm/*","*://*clubtime.fm/*","*://*teatime.fm/*","*://*replay.fm/*"],js:"technobase.fm.js",id:"technobase.fm"},{label:"Telegram A",matches:["*://web.telegram.org/a/*"],js:"telegram-a.js",id:"telegram-a"},{label:"Telegram K",matches:["*://web.telegram.org/k/*"],js:"telegram-k.js",id:"telegram-k"},{label:"TuneGenieEmbed",matches:["*://b3.tunegenie.com/*"],js:"tunegenie-embed.js",id:"tunegenie-embed",allFrames:!0},{label:"TuneGenie",matches:["*://*.tunegenie.com/*"],js:"tunegenie.js",id:"tunegenie"},{label:"RTL+ Musik",matches:["*://plus.rtl.de/*"],js:"rtl-plus-musik.js",id:"rtl-plus-musik"},{label:"Tomorrowland",matches:["*://www.tomorrowland.com/*"],js:"tomorrowland.js",id:"tomorrowland"},{label:"hearthis.at",matches:["*://hearthis.at/*"],js:"hearthis-at.js",id:"hearthis-at"},{label:"Blend",matches:["*://blend.io/*"],js:"blend.js",id:"blend"},{label:"Radio Italia",matches:["*://www.radioitalia.it/*"],js:"radio-italia.js",id:"radio-italia"},{label:"Lyden av Norge",matches:["*://www.lydenavnorge.no/*"],js:"lyden-av-norge.js",id:"lyden-av-norge"},{label:"audio.com",matches:["*://audio.com/*"],js:"audio.js",id:"audio-com"},{label:"AfroCharts",matches:["*://*.afrocharts.com/*"],js:"afrocharts.js",id:"afrocharts"},{label:"Ed Banger Records",matches:["*://*.edbangerrecords.com/*"],js:"ed-banger-records.js",id:"ed-banger-records"},{label:"Hyperpipe",matches:["*://hyperpipe.surge.sh/*"],js:"hyperpipe.js",id:"hyperpipe"},{label:"Radiofreccia",matches:["*://play.rtl.it/live/*"],js:"radiofreccia.js",id:"radiofreccia"},{label:"khinsider",matches:["*://downloads.khinsider.com/*"],js:"khinsider.js",id:"khinsider"},{label:"WDR",matches:["*://*.wdr.de/radio/*"],js:"wdr.js",id:"wdr"},{label:"radio.de",matches:["*://www.radio.de/*"],js:"radio.de.js",id:"radiode"},{label:"FMSpins",matches:["*://*.fmspins.com/*"],js:"fmspins.js",id:"fmspins"},{label:"vk-save",matches:["*://*.vk-save.com/*"],js:"vk-save.js",id:"vk-save"},{label:"Radio Student",matches:["*://www.radiostudent.hr/*"],js:"radiostudent.js",id:"radiostudent"},{label:"BiliBili",matches:["*://www.bilibili.com/*"],js:"bilibili.js",id:"bilibili",usesBlocklist:!0},{label:"jam.coop",matches:["*://jam.coop/*"],js:"jam.coop.js",id:"jam.coop"},{label:"Zing MP3",matches:["*://zingmp3.vn/*"],js:"zingmp3.js",id:"zingmp3"},{label:"NTS",matches:["*://*nts.live/*"],js:"nts.js",id:"nts"},{label:"earth.fm",matches:["*://earth.fm/*"],js:"earth.fm.js",id:"earthfm"},{label:"apt-get's auditorium",matches:["*://tunes.apt-get.xyz/*"],js:"apt-get-tunes.js",id:"apt-get-tunes"},{label:"AzuraCast",js:"azuracast.js",id:"azuracast"},{label:"scrobblerad.io",matches:["*://scrobblerad.io/*"],js:"scrobbleradio.js",id:"scrobbleradio"},{label:"weareone.fm",matches:["*://weareone.fm/*"],js:"weareone.js",id:"weareone"},{label:"Bollerwagen",matches:["*://radiobollerwagen.de/*"],js:"bollerwagen.js",id:"bollerwagen"},{label:"МТС Музыка",matches:["*://music.mts.ru/*"],js:"mts-music.js",id:"mts-music"},{label:"ChirpRadio",matches:["*://chirpradio.org/*"],js:"chirpradio.js",id:"chirpradio"},{label:"OnlyHit",matches:["*://onlyhit.us/*"],js:"onlyhit.js",id:"onlyhit"},{label:"InstantAudio",matches:["*://instant.audio/*","*://radiosdecuba.com/*","*://radio.ht/*","*://jamaicaradio.net/*","*://emisoras.com.mx/*","*://radiosdepuertorico.com/*","*://radios.com.do/*","*://trinidadradiostations.net/*","*://radios.co.cr/*","*://radios.com.sv/*","*://emisoras.com.gt/*","*://radios.hn/*","*://radios.co.ni/*","*://radios.com.pa/*","*://radioarg.com/*","*://radios.com.bo/*","*://radiosaovivo.net/*","*://emisora.cl/*","*://radios.com.co/*","*://radios.com.ec/*","*://emisoras.com.py/*","*://radios.com.pe/*","*://surinaamseradio.com/*","*://radios.com.uy/*","*://radio.co.ve/*","*://radiosonline.be/*","*://ceskaradiaonline.cz/*","*://radio.co.dk/*","*://radiolisten.de/*","*://raadiod.com/*","*://emisora.org.es/*","*://ecouterradioenligne.com/*","*://radiofona.com.gr/*","*://radios.hr/*","*://ieradio.org/*","*://ascoltareradio.com/*","*://latvijasradio.com/*","*://radios.lu/*","*://radijas.org/*","*://radiohallgatas.hu/*","*://nederlandseradio.nl/*","*://nettradionorge.com/*","*://radios.co.at/*","*://onlineradio.pl/*","*://radioonline.com.pt/*","*://radio.org.ro/*","*://radiosonline.ch/*","*://siradio.si/*","*://radiostanice.rs/*","*://nettiradiot.org/*","*://radio.org.se/*","*://internetradiouk.com/*","*://bg-radio.org/*","*://radio.pp.ru/*","*://radioua.net/*","*://radioalgerie.eu/*","*://radio.co.cm/*","*://radio.cd/*","*://radio.co.ci/*","*://radio.com.gh/*","*://radio.or.ke/*","*://radio.mg/*","*://radio.co.ma/*","*://egyptradio.net/*","*://radio.org.ng/*","*://radio.sn/*","*://radiosa.org/*","*://radiotunisienne.org/*","*://radio.co.ug/*","*://radio-bd.com/*","*://radioonline.kr/*","*://radios.hk/*","*://onlineradios.in/*","*://radioonline.co.id/*","*://radioonline.my/*","*://radionp.com/*","*://jpradio.jp/*","*://radio.net.pk/*","*://radio.org.ph/*","*://radiosingapore.org/*","*://radio.com.lk/*","*://vietnamradio.org/*","*://radios.org.il/*","*://radioth.net/*","*://zhibo.fm/*","*://radios.tw/*","*://radioau.net/*","*://radio.org.nz/*"],js:"instantaudio.js",id:"instantaudio"},{label:"Basspistol Radio",matches:["*://*.basspistol.com/*"],js:"basspistol.js",id:"basspistol"},{label:"RadioFreeFedi",matches:["*://radiofreefedi.net/*"],js:"radiofreefedi.js",id:"radiofreefedi"},{label:"MyTuner",matches:["*://mytuner-radio.com/*"],js:"mytuner.js",id:"mytuner"},{label:"Mirlo",matches:["*://mirlo.space/*"],js:"mirlo.js",id:"mirlo"},{label:"Simulator Radio",matches:["*://*.simulatorradio.com/*"],js:"simulatorradio.js",id:"simulatorradio"},{label:"Echo",matches:["*://echo.sleepyfran.me/*"],js:"echo.js",id:"echo"},{label:"Gizz Tapes",matches:["*://tapes.kglw.net/*"],js:"tapes-kglw.js",id:"tapes-kglw"},{label:"Systrum Sistum Radio",matches:["*://systrum.net/*"],js:"systrum.js",id:"systrum"},{label:"cosine.club",matches:["*://cosine.club/*"],js:"cosine.club.js",id:"cosine.club"},{label:"The Indie Beat Radio",matches:["*://theindiebeat.fm/*"],js:"theindiebeat.js",id:"theindiebeat"},{label:"Musique Approximative",matches:["*://*.musiqueapproximative.net/*"],js:"musiqueapproximative.js",id:"musiqueapproximative"},{label:"Suno AI",matches:["*://suno.com/*"],js:"suno.js",id:"suno"},{label:"[untitled]",matches:["*://untitled.stream/*"],js:"untitled.js",id:"[untitled]"},{label:"DAB Music Player",matches:["*://dab.yeet.su/*","*://dabmusic.xyz/*"],js:"dabmusic.js",id:"dabmusic"},{label:"GBS-FM",matches:["*://gbs.fm/*"],js:"gbs.fm.js",id:"gbs"},{label:"Yumi Co. Radio",matches:["*://yumicoradio.net/*"],js:"yumicoradio.js",id:"yumicoradio"},{label:"Kosmik Dstroyer",matches:["*://kosmik-dstroyer.top/*"],js:"kosmik-dstroyer.js",id:"kosmik-dstroyer"},{label:"LaTeX 4000",matches:["*://nonacademic.net/*"],js:"nonacademic.js",id:"nonacademic"},{label:"gravity.fm",matches:["*://gravity.fm/*"],js:"gravity.fm.js",id:"gravity"},{label:"Archaic Horizon",matches:["*://archaichorizon.com/*","*://www.archaichorizon.com/*"],js:"archaichorizon.js",id:"archaichorizon"},{label:"Aonsoku",matches:["*://aonsoku.vercel.app/*"],js:"aonsoku.js",id:"aonsoku"},{label:"CREAMER NATION",matches:["*://creamernation.men/*"],js:"creamernation.js",id:"creamer-nation"}];function dt(s){return s.replace(/[$()*+.?[\\^{|}]/g,"\\$&")}function ut(s){return s.split("*").map(dt).join(".*")}function ls(s){if(typeof s!="string")return null;const e=/^(\*|https?):\/\/([^/]*)(\/.*)/.exec(s);if(!e)return null;const t=e[1],a=e[2],r=e[3];let n="^";if(t==="*"?n+="https?":n+=`${t}`,n+=dt("://"),a==="*")n+="[^\\/]+";else if(a){let g=a;a.startsWith("*.")&&(n+="([^\\/]+\\.|)",g=g.substr(2)),n+=ut(g)}else return null;return n+=ut(r),n+="$",new RegExp(n)}function cs(s,e){const t=ls(e);return t?t.test(s):!1}const ds=L(ve);function us(){return ds.get()}async function Ne(s){const e=await us()||{};for(const t of Pe){const a=t.matches||[];e[t.id]&&a.push(...e[t.id]);for(const r of a)if(cs(s,r))return t}return null}const N=L(Te),q=L(Ae),ie=L(ke),oe="useNotifications",ne="useUnrecognizedSongNotifications",Oe="showInfobox",Ce="scrobblePodcasts",Ie="autoToggleLove",Ue="forceRecognize",_e="scrobbleRecognizedTracks",Me="scrobbleEditedTracksOnly",mt="scrobblePercent",O="disabledConnectors",gt="debugLoggingEnabled",bt="albumGuessingDisabled",ht="albumGuessingUneditedOnly",ft="albumGuessingAllTracks",pt={[Ue]:!1,[Ce]:!0,[oe]:!0,[ne]:!1,[_e]:!0,[Me]:!1,[gt]:!1,[mt]:Jt,[Oe]:!0,[Ie]:!0,[bt]:!1,[ht]:!0,[ft]:!1,[O]:{}},ms={[Ue]:!1,[_e]:!0,[Me]:!1,[Ce]:!0,[oe]:!0,[ne]:!1,[Oe]:!0,[Ie]:!0},K={YouTube:{scrobbleMusicOnly:!1,scrobbleEntertainmentOnly:!1,scrobbleMusicRecognisedOnly:!1,enableGetTrackInfoFromYtMusic:!1}};async function gs(){const s={...pt,...await N.get()};await N.set(s),N.debugLog([O]);const e={...K,...await q.get()};for(const t in K){const a=t;e[a]={...K[a],...e[a]}}await q.set(e),q.debugLog(),ie.debugLog()}async function bs(){const s=await N.get();if(!s)throw new Error("No options data found");for(const e of Object.keys(s[O])){let t=!1;for(const a of Pe)if(a.id===e){t=!0;break}t||(delete s[O][e],S(`Remove ${e} from storage`))}}async function De(s,e){if(jt(s),e!==void 0){const a=await wt(e,s);if(a!==void 0)return a}return(await N.get())?.[s]}async function hs(s,e){jt(s),await N.update({[s]:e})}async function fs(s,e){return yt(s),At(s,e),(await q.get())?.[s][e]}async function ps(s,e,t){yt(s),At(s,e);const a=await q.get();if(!a?.[s])throw new Error(`Connector ${s} not found in storage`);a[s][e]=t,await q.set(a)}async function wt(s,e){return js(e)?(await ie.get())?.[s]?.[e]:void 0}async function ws(s,e,t){const a=await ie.get();if(!a)throw new Error("No connectors override data found");a[s]||(a[s]={}),a[s][e]=t,await ie.set(a)}function jt(s){if(!(s in pt))throw new Error(`Unknown option key: ${s}`);return!0}function js(s){return s in ms}function yt(s){if(!(s in K))throw new Error(`Unknown connector: ${s}`);return!0}function At(s,e){if(!(e in K[s]))throw new Error(`Unknown connector option key: ${e}`);return!0}async function ys(s){const e=await N.get();if(!e)throw new Error("No options data found");return!e[O][s.id]}async function As(s,e){const t=await N.get();if(!t)throw new Error("No options data found");e?delete t[O][s.id]:t[O][s.id]=!0,await N.set(t)}async function ks(s){const e=await N.get();if(!e)throw new Error("No options data found");if(e[O]={},!s)for(const t of Pe)e[O][t.id]=!0;await N.set(e)}gs().then(bs);const vs=Object.freeze(Object.defineProperty({__proto__:null,ALBUM_GUESSING_ALL_TRACKS:ft,ALBUM_GUESSING_DISABLED:bt,ALBUM_GUESSING_UNEDITED_ONLY:ht,AUTO_TOGGLE_LOVE:Ie,DEBUG_LOGGING_ENABLED:gt,DISABLED_CONNECTORS:O,FORCE_RECOGNIZE:Ue,SCROBBLE_EDITED_TRACKS_ONLY:Me,SCROBBLE_PERCENT:mt,SCROBBLE_PODCASTS:Ce,SCROBBLE_RECOGNIZED_TRACKS:_e,USE_INFOBOX:Oe,USE_NOTIFICATIONS:oe,USE_UNRECOGNIZED_SONG_NOTIFICATIONS:ne,getConnectorOption:fs,getConnectorOverrideOption:wt,getOption:De,isConnectorEnabled:ys,setAllConnectorsEnabled:ks,setConnectorEnabled:As,setConnectorOption:ps,setConnectorOverrideOption:ws,setOption:hs},Symbol.toStringTag,{value:"Module"}));class ze{getArtist(){return this.processed.artist||this.parsed.artist}getTrack(){return this.processed.track||this.parsed.track}getAlbum(){return this.processed.album||this.parsed.album}getAlbumArtist(){return this.processed.albumArtist||this.parsed.albumArtist}getDuration(){return this.parsed.duration||this.processed.duration}getTrackArt(){return this.parsed.trackArt||this.metadata.trackArtUrl||null}getArtistTrackString(){return this.isEmpty()?null:`${this.getArtist()??"undefined"} — ${this.getTrack()??"undefined"}`}getUniqueId(){return this.parsed.uniqueID}getOriginUrl(){return this.parsed.originUrl}isEmpty(){return!(this.getArtist()&&this.getTrack())}isValid(){return this.flags.isValid||this.flags.isCorrectedByUser}equals(e){if(!e||!(e instanceof ze))return!1;const t=this.getUniqueId(),a=e.getUniqueId();return t||a?t===a:this.getArtist()===e.getArtist()&&this.getTrack()===e.getTrack()&&this.getAlbum()===e.getAlbum()}toString(){return JSON.stringify(this,null,2)}getCloneableData(){return{parsed:this.parsed,noRegex:this.noRegex,processed:this.processed,metadata:this.metadata,flags:this.flags,connector:this.connector}}setLoveStatus(e,t=!1){if(t){this.metadata.userloved=e;return}e?this.metadata.userloved===void 0&&(this.metadata.userloved=!0):this.metadata.userloved=!1}static get USER_FIELDS(){return["artist","track","album","albumArtist"]}static get BASE_FIELDS(){return["artist","track","album","albumArtist"]}static get PROCESSED_FIELDS(){return["track","album","artist","albumArtist","duration"]}}var le={exports:{}},Ss=le.exports,kt;function Rs(){return kt||(kt=1,(function(s){(function(e){function t(l,c){var i=(l&65535)+(c&65535),h=(l>>16)+(c>>16)+(i>>16);return h<<16|i&65535}function a(l,c){return l<<c|l>>>32-c}function r(l,c,i,h,w,y){return t(a(t(t(c,l),t(h,y)),w),i)}function n(l,c,i,h,w,y,v){return r(c&i|~c&h,l,c,w,y,v)}function g(l,c,i,h,w,y,v){return r(c&h|i&~h,l,c,w,y,v)}function p(l,c,i,h,w,y,v){return r(c^i^h,l,c,w,y,v)}function j(l,c,i,h,w,y,v){return r(i^(c|~h),l,c,w,y,v)}function R(l,c){l[c>>5]|=128<<c%32,l[(c+64>>>9<<4)+14]=c;var i,h,w,y,v,u=1732584193,o=-271733879,m=-1732584194,d=271733878;for(i=0;i<l.length;i+=16)h=u,w=o,y=m,v=d,u=n(u,o,m,d,l[i],7,-680876936),d=n(d,u,o,m,l[i+1],12,-389564586),m=n(m,d,u,o,l[i+2],17,606105819),o=n(o,m,d,u,l[i+3],22,-1044525330),u=n(u,o,m,d,l[i+4],7,-176418897),d=n(d,u,o,m,l[i+5],12,1200080426),m=n(m,d,u,o,l[i+6],17,-1473231341),o=n(o,m,d,u,l[i+7],22,-45705983),u=n(u,o,m,d,l[i+8],7,1770035416),d=n(d,u,o,m,l[i+9],12,-1958414417),m=n(m,d,u,o,l[i+10],17,-42063),o=n(o,m,d,u,l[i+11],22,-1990404162),u=n(u,o,m,d,l[i+12],7,1804603682),d=n(d,u,o,m,l[i+13],12,-40341101),m=n(m,d,u,o,l[i+14],17,-1502002290),o=n(o,m,d,u,l[i+15],22,1236535329),u=g(u,o,m,d,l[i+1],5,-165796510),d=g(d,u,o,m,l[i+6],9,-1069501632),m=g(m,d,u,o,l[i+11],14,643717713),o=g(o,m,d,u,l[i],20,-373897302),u=g(u,o,m,d,l[i+5],5,-701558691),d=g(d,u,o,m,l[i+10],9,38016083),m=g(m,d,u,o,l[i+15],14,-660478335),o=g(o,m,d,u,l[i+4],20,-405537848),u=g(u,o,m,d,l[i+9],5,568446438),d=g(d,u,o,m,l[i+14],9,-1019803690),m=g(m,d,u,o,l[i+3],14,-187363961),o=g(o,m,d,u,l[i+8],20,1163531501),u=g(u,o,m,d,l[i+13],5,-1444681467),d=g(d,u,o,m,l[i+2],9,-51403784),m=g(m,d,u,o,l[i+7],14,1735328473),o=g(o,m,d,u,l[i+12],20,-1926607734),u=p(u,o,m,d,l[i+5],4,-378558),d=p(d,u,o,m,l[i+8],11,-2022574463),m=p(m,d,u,o,l[i+11],16,1839030562),o=p(o,m,d,u,l[i+14],23,-35309556),u=p(u,o,m,d,l[i+1],4,-1530992060),d=p(d,u,o,m,l[i+4],11,1272893353),m=p(m,d,u,o,l[i+7],16,-155497632),o=p(o,m,d,u,l[i+10],23,-1094730640),u=p(u,o,m,d,l[i+13],4,681279174),d=p(d,u,o,m,l[i],11,-358537222),m=p(m,d,u,o,l[i+3],16,-722521979),o=p(o,m,d,u,l[i+6],23,76029189),u=p(u,o,m,d,l[i+9],4,-640364487),d=p(d,u,o,m,l[i+12],11,-421815835),m=p(m,d,u,o,l[i+15],16,530742520),o=p(o,m,d,u,l[i+2],23,-995338651),u=j(u,o,m,d,l[i],6,-198630844),d=j(d,u,o,m,l[i+7],10,1126891415),m=j(m,d,u,o,l[i+14],15,-1416354905),o=j(o,m,d,u,l[i+5],21,-57434055),u=j(u,o,m,d,l[i+12],6,1700485571),d=j(d,u,o,m,l[i+3],10,-1894986606),m=j(m,d,u,o,l[i+10],15,-1051523),o=j(o,m,d,u,l[i+1],21,-2054922799),u=j(u,o,m,d,l[i+8],6,1873313359),d=j(d,u,o,m,l[i+15],10,-30611744),m=j(m,d,u,o,l[i+6],15,-1560198380),o=j(o,m,d,u,l[i+13],21,1309151649),u=j(u,o,m,d,l[i+4],6,-145523070),d=j(d,u,o,m,l[i+11],10,-1120210379),m=j(m,d,u,o,l[i+2],15,718787259),o=j(o,m,d,u,l[i+9],21,-343485551),u=t(u,h),o=t(o,w),m=t(m,y),d=t(d,v);return[u,o,m,d]}function k(l){var c,i="",h=l.length*32;for(c=0;c<h;c+=8)i+=String.fromCharCode(l[c>>5]>>>c%32&255);return i}function M(l){var c,i=[];for(i[(l.length>>2)-1]=void 0,c=0;c<i.length;c+=1)i[c]=0;var h=l.length*8;for(c=0;c<h;c+=8)i[c>>5]|=(l.charCodeAt(c/8)&255)<<c%32;return i}function he(l){return k(R(M(l),l.length*8))}function $(l,c){var i,h=M(l),w=[],y=[],v;for(w[15]=y[15]=void 0,h.length>16&&(h=R(h,l.length*8)),i=0;i<16;i+=1)w[i]=h[i]^909522486,y[i]=h[i]^1549556828;return v=R(w.concat(M(c)),512+c.length*8),k(R(y.concat(v),640))}function D(l){var c="0123456789abcdef",i="",h,w;for(w=0;w<l.length;w+=1)h=l.charCodeAt(w),i+=c.charAt(h>>>4&15)+c.charAt(h&15);return i}function z(l){return unescape(encodeURIComponent(l))}function fe(l){return he(z(l))}function pe(l){return D(fe(l))}function we(l,c){return $(z(l),z(c))}function je(l,c){return D(we(l,c))}function ye(l,c,i){return c?i?we(c,l):je(c,l):i?fe(l):pe(l)}s.exports?s.exports=ye:e.md5=ye})(Ss)})(le)),le.exports}var Es=Rs();const Ts=Ve(Es);class Ls{storageRef;constructor(){this.storageRef=null}_init(e){this.storageRef=e}async clear(){if(this.storageRef)return await this.storageRef.clear()}async getData(){return this.storageRef?await this.storageRef.get():(U("Storage reference is not initialized","warn"),null)}async saveData(e){if(!this.storageRef){U("Storage reference is not initialized","warn");return}return await this.storageRef.set(e)}async updateData(e){if(!this.storageRef){U("Storage reference is not initialized","warn");return}return await this.storageRef.update(e)}}const xs=[{search:{track:null,artist:null,album:"(.*) - Single",albumArtist:null},replace:{track:null,artist:null,album:"$1",albumArtist:null}},{search:{track:null,artist:null,album:"(.*) - EP",albumArtist:null},replace:{track:null,artist:null,album:"$1",albumArtist:null}}];async function Ps(){const s=L(Le);await s.get()||s.set(xs)}class Ns extends Ls{MAX_SCROBBLE_CACHE_SIZE=1e3;async replaceScrobble(e,t){const a=await this.getScrobbleCacheStorageLocking();if(a){for(let r=0;r<a.length;r++)a[r].id===e&&(a[r]={...t,id:e});await this.saveScrobbleCacheToStorageLocking(a)}}async pushScrobble(e){const t=await this.getScrobbleCacheStorageLocking();if(t===null)return await this.saveScrobbleCacheToStorageLocking([{...e,id:1}]),1;const a=(t.at(-1)?.id??0)+1;return t.push({...e,id:a}),await this.saveScrobbleCacheToStorageLocking(t.slice(-this.MAX_SCROBBLE_CACHE_SIZE)),a}async deleteScrobbles(e){const t=await this.getScrobbleCacheStorageLocking();if(!t)return;const a=new Map;for(const r of e)a.set(r,!0);await this.saveScrobbleCacheToStorageLocking(t.filter(r=>a.get(r.id)!==!0))}}class Os extends Ns{scrobbleCacheStorage=this.getStorage();init(){this._init(re(ae))}async getScrobbleCacheStorage(){return this.scrobbleCacheStorage.get()}async getScrobbleCacheStorageLocking(){return this.scrobbleCacheStorage.getLocking()}async saveScrobbleCacheToStorage(e){return await this.scrobbleCacheStorage.set(e)}async saveScrobbleCacheToStorageLocking(e){return await this.scrobbleCacheStorage.setLocking(e)}getStorage(){return L(ae)}}const Cs=new Os,Be={[It]:!0,[Dt]:!0,[zt]:!0,[Bt]:!0,[Mt]:!0,[Ft]:!0,[_t]:!0,[Ut]:!0,[qt]:!0,[$t]:!0};L(se);class C extends ze{parsed;processed;noRegex;flags;metadata;connector;controllerTabId;constructor(e,t){super(),this.parsed=e.parsed,this.processed=e.processed,this.noRegex=e.noRegex,this.flags=e.flags,this.metadata=e.metadata,this.connector=e.connector,this.controllerTabId=t}resetData(){P(this.controllerTabId,{type:"resetData",payload:void 0})}resetInfo(){P(this.controllerTabId,{type:"resetInfo",payload:void 0})}}async function Is(s){ts({type:"currentTab",payload:s}).catch(e=>{console.warn(e)}),await Us(s),_s(s)}async function Us(s){if(s.mode===G){b.contextMenus?.update(A.ENABLE_CONNECTOR,{visible:!1}),b.contextMenus?.update(A.DISABLE_CONNECTOR,{visible:!1}),b.contextMenus?.update(A.DISABLE_UNTIL_CLOSED,{visible:!1}),b.contextMenus?.update(A.DISABLE_CHANNEL,{visible:!1}),b.contextMenus?.update(A.ENABLE_CHANNEL,{visible:!1});return}const e=await b.tabs.get(s.tabId),t=await Ne(e.url??"");if(s.mode===Je){b.contextMenus?.update(A.ENABLE_CONNECTOR,{visible:!0,title:B("menuEnableConnector",t?.label)}),b.contextMenus?.update(A.DISABLE_CONNECTOR,{visible:!1}),b.contextMenus?.update(A.DISABLE_UNTIL_CLOSED,{visible:!1}),b.contextMenus?.update(A.DISABLE_CHANNEL,{visible:!1}),b.contextMenus?.update(A.ENABLE_CHANNEL,{visible:!1});return}b.contextMenus?.update(A.ENABLE_CONNECTOR,{visible:!1}),b.contextMenus?.update(A.DISABLE_CONNECTOR,{visible:!0,title:B("menuDisableConnector",t?.label)}),b.contextMenus?.update(A.DISABLE_UNTIL_CLOSED,{visible:!0,title:B("menuDisableUntilTabClosed",t?.label)});const a=await Bs(s.tabId);!a||!a.channelInfo?.id||!a.connector?(b.contextMenus?.update(A.DISABLE_CHANNEL,{visible:!1}),b.contextMenus?.update(A.ENABLE_CHANNEL,{visible:!1})):await Fs(a.channelInfo.id,a.connector)?(b.contextMenus?.update(A.DISABLE_CHANNEL,{visible:!1}),b.contextMenus?.update(A.ENABLE_CHANNEL,{visible:!0,title:B("menuEnableChannel",a.channelInfo.label)})):(b.contextMenus?.update(A.DISABLE_CHANNEL,{visible:!0,title:B("menuDisableChannel",a.channelInfo.label)}),b.contextMenus?.update(A.ENABLE_CHANNEL,{visible:!1}))}function ce(s){const e=b.runtime.getURL(s);return e.startsWith("safari")?s:e}async function _s(s){let e="";if(s.song){const r=new C(s.song,-1);e=`${r.getArtist()} - ${r.getTrack()}`}const t=await Ms(),a=r=>`icons/action_${s.mode.toLowerCase()}_${r}_${t}.png`;b.action.setIcon({path:{16:ce(a(16)),19:ce(a(19)),32:ce(a(32)),38:ce(a(38))}}),b.action.setTitle({title:B(`pageAction${s.mode}`,e)})}async function Ms(){return b.notifications?Gs():"safari"}const W=L(te),Ds=L(Ee),A={ENABLE_CONNECTOR:"enableConnector",DISABLE_CONNECTOR:"disableConnector",DISABLE_UNTIL_CLOSED:"disableUntilClosed",ENABLE_CHANNEL:"enableChannel",DISABLE_CHANNEL:"disableChannel"};async function zs(s,e){if(!s)return[];const t=[];for(const r of s)t.push(e(r));const a=[];for(const[r,n]of(await Promise.all(t)).entries())n&&a.push(s[r]);return a}async function Fe(s){return zs(s,async e=>{try{const t=await b.tabs.get(e.tabId);return await Ne(t.url??""),!0}catch{return!1}})}async function Bs(s){return P(s,{type:"getChannelDetails",payload:void 0})}async function Fs(s,e){const t=(await Ds.get())?.[e.id];return!t||!t[s]?null:t[s]}function qs(){return W.unlock()}async function J(s){return W.setLocking(s)}async function de(s,e){const t=await qe(s,e);return Is(t),t}async function qe(s,e){const t=Hs(s);let a=e;a||(a=await ue());const r=await $s(a);return t&&!Be[r.mode]?t:r}async function $s(s){try{if(!await b.tabs.get(s))throw new Error("Tab not found");const t=await P(s,{type:"getConnectorDetails",payload:void 0});return{tabId:s,mode:t.mode,permanentMode:t.permanentMode,song:t.song}}catch{return{tabId:s,mode:G,permanentMode:G,song:null}}}function Hs(s){for(const e of s)if(Be[e.mode])return e;return null}async function ue(){const s={active:!0,lastFocusedWindow:!0},[e]=await b.tabs.query(s);return e?.id??-1}async function vt(){const s=await W.get()??$e;return qe(s.activeTabs)}async function me(){return await W.getLocking()??$e}async function Gs(){return(await W.get())?.browserPreferredTheme??"light"}const $e={activeTabs:[],browserPreferredTheme:"light"};function St(s){P(s,{type:"setConnectorState",payload:!1})}function Rt(s){P(s,{type:"setConnectorState",payload:!0})}function Ks(s){P(s,{type:"addToBlocklist",payload:void 0})}function Ws(s){P(s,{type:"removeFromBlocklist",payload:void 0})}function Js(s){P(s,{type:"disableConnectorUntilTabIsClosed",payload:void 0})}class Vs{storage=L(Re);async saveHasNotified(e){if(!e)return;let t=await this.storage.getLocking();t||(t={}),t[e]=!0,await this.storage.setLocking(t)}async shouldNotifyAboutNativeScrobbler(e){const t=await this.storage.get();return t?!t[e]:!0}}const Qs=b.runtime.getManifest(),Ys={type:"basic",iconUrl:b.runtime.getURL(Qs.icons?.["128"]??"")},ge=b.runtime.getURL("/img/cover_art_default.png"),Zs=b.runtime.getURL("img/cover_art_unknown.png"),Xs=5e3,V={};let be=null;async function ea(){return b?.notifications?await Yt()==="mac"?!await Zt():!0:!1}async function Et(s){return De(oe,s.id)}function ta(s,e){V[s]=e}function sa(s){V[s]&&delete V[s]}async function Q(s,e){if(!await ea())throw new Error("Notifications are not available");typeof e=="function"&&(s.isClickable=!0);const t={...Ys,...s};let a;try{a=await b.notifications?.create("",t)}catch(r){if(t.iconUrl===ge)throw r;t.iconUrl=ge,a=await b.notifications?.create("",t)}return typeof e=="function"&&ta(a,e),a}async function aa(s){const e=new Vs;if(!s.hasNativeScrobbler||!await e.shouldNotifyAboutNativeScrobbler(s.id))return;const t={title:b.i18n.getMessage("notificationNativeScrobbler",s.label),message:b.i18n.getMessage("notificationNativeScrobblerText")};try{await Q(t,()=>{b.tabs.create({url:b.runtime.getURL("src/ui/options/index.html?p=connectors")})}),await e.saveHasNotified(s.id)}catch(a){S("Unable to show native scrobbler notification: ","warn"),S(a,"warn")}}async function ra(s,e,t){if(!await Et(e))return;const a=s.metadata.label,r=s.getTrackArt()||ge;let n=s.getArtist(),g=s.getTrack();const p=s.getAlbum();p&&(n=`${n??"null"}
${p}`);const j=s.metadata.userPlayCount;if(j){const k=b.i18n.getMessage("infoYourScrobbles",j.toString());n=`${n??"null"}
${k}`}const R={iconUrl:r,title:g??"null",message:n??"null",silent:!0,contextMessage:a};Tt(),be=setTimeout(()=>{Q(R,t).then(k=>{s.metadata.notificationId=k}).catch(k=>{S("Unable to show now playing notification: ","warn"),S(k,"warn")})},Xs)}function ia(s){if(!s.metadata.notificationId)throw new Error("Notification ID is not set");Tt(),ma(s.metadata.notificationId)}async function oa(s,e,t){if(!await De(ne,e.id))return;const a={iconUrl:Zs,title:b.i18n.getMessage("notificationNotRecognized"),message:b.i18n.getMessage("notificationNotRecognizedText")};try{const r=await Q(a,t);s.metadata.notificationId=r}catch(r){S("Unable to show song not recognized notification: ","warn"),S(r,"warn")}}const na=3,He=L(Se);async function la(){return((await He.get())?.authDisplayCount||0)<na}async function ca(){let s=await He.get();s||(s={authDisplayCount:0}),s.authDisplayCount=s.authDisplayCount+1,await He.set(s)}async function da(){if(!await la())return;const s={title:b.i18n.getMessage("notificationConnectAccounts"),message:b.i18n.getMessage("notificationConnectAccountsText")};try{await Q(s,()=>{b.tabs.create({url:b.runtime.getURL("src/ui/options/index.html?p=accounts")})})}catch(e){S("Unable to show auth notification: ","warn"),S(e,"warn"),b.tabs.create({url:b.runtime.getURL("src/ui/options/index.html?p=accounts")})}ca()}async function ua(s,e){if(!await Et(s.connector))return;const t=s.getTrackArt()||ge,a=`${s.getTrack()}
${s.getArtist()}`,r=e?b.i18n.getMessage("pageActionLoved",a):b.i18n.getMessage("pageActionUnloved",a),n={iconUrl:t,title:r,message:a};try{await Q(n,null)}catch(g){S("Unable to show loved notification: ","warn"),S(g,"warn")}}function ma(s){s&&b.notifications?.clear(s)}function Tt(){be&&(clearTimeout(be),be=null)}b.notifications?.onClicked.addListener(s=>{S(`Notification onClicked: ${s}`),V[s]&&V[s](s)}),b.notifications?.onClosed.addListener(s=>{sa(s)});async function ga(s){if(typeof s.id>"u")throw new Error(`Could not identify tab: ${JSON.stringify(s)}`);let e=s.url;if(typeof e>"u"&&(e=await b.tabs.get(s.id).then(t=>t.url)),typeof e>"u")throw new Error(`Could not identify URL of tab: ${JSON.stringify(s)}`);return ba(s.id,e)}async function ba(s,e){if(!await Ne(e))return;b.scripting.executeScript({target:{tabId:s},files:["content/main.js"]})}async function ha(){const s=await b.tabs?.query({});for(const e of s??[])try{await ga(e)}catch(t){console.warn("Error while injecting into tab: ",t)}}class Y{storage;userApiUrl=null;userToken=null;arrayProperties=null;constructor(){this.storage=this.initStorage(),this.initUserProps(),at(E({type:"updateScrobblerProperties",fn:()=>{this.initUserProps()}}))}async getUserProperties(){const e=await this.storage.get();return!e||!("properties"in e)||!e.properties?{}:e.properties}async applyUserProperties(e){this.applyProps(e,this.getUserDefinedProperties());let t=await this.storage.get();if(t||(t={}),!t){U("No data in storage","error");return}if((!("properties"in t)||t.properties===void 0)&&(t.properties={}),!("properties"in t)||t.properties===void 0){U("No properties in storage","error");return}for(const a in e){const r=e[a];r?t.properties[a]=r:a in t.properties&&delete t.properties[a]}await this.storage.set(t)}getUserDefinedProperties(){return[]}getUserDefinedArrayProperties(){return[]}async getArrayProperties(){const e=await this.storage.get();return!e||!("arrayProperties"in e)||!e.arrayProperties?[]:e.arrayProperties}async addUserArrayProperties(e){let t=await this.storage.get();if((!t||!("arrayProperties"in t)||!t.arrayProperties)&&(t={arrayProperties:[]}),!t||!("arrayProperties"in t)||!t.arrayProperties){U("No data in storage","error");return}t.arrayProperties.push(e),this.applyArrayProps(t.arrayProperties,this.getUserDefinedArrayProperties()),await this.storage.set(t)}async applyUserArrayProperties(e){let t=await this.storage.get();if((!t||!("arrayProperties"in t)||!t.arrayProperties)&&(t={arrayProperties:[]}),!t||!("arrayProperties"in t)||!t.arrayProperties){U("No data in storage","error");return}t.arrayProperties=e,this.applyArrayProps(t.arrayProperties,this.getUserDefinedArrayProperties()),await this.storage.set(t)}async signOut(){const e=await this.storage.get();if(!e){U("No data in storage","error");return}"sessionID"in e&&delete e.sessionID,"sessionName"in e&&delete e.sessionName,"arrayProperties"in e&&delete e.arrayProperties,await this.storage.set(e)}async getProfileUrl(){const{sessionName:e}=await this.getSession();return`${this.getBaseProfileUrl()}${e??"undefined"}`}canLoveSong(){return!1}canLoadSongInfo(){return!1}applyFilter(e){return e}get REQUEST_TIMEOUT(){return 15e3}debugLog(e,t="log"){const a=`${this.getLabel()}: ${e}`;U(a,t)}initStorage(){const e=["token","sessionID","sessionName"];e.push(...this.getUserDefinedProperties());const t=lt(this.getStorageName());return t.debugLog(e),t}async initUserProps(){const e=await this.storage.get();if(e&&"properties"in e)for(const t in e.properties)t==="userApiUrl"&&"userApiUrl"in e.properties&&(this.userApiUrl=e.properties.userApiUrl),t==="userToken"&&"userToken"in e.properties&&(this.userToken=e.properties.userToken);e&&"arrayProperties"in e&&(this.arrayProperties=e.arrayProperties??[])}applyProps(e,t){for(const a in e){if(!t.includes(a))throw new Error(`Unknown property: ${a}`);const r=e[a];if(r===void 0)throw new Error(`Property is not set: ${a}`);r&&a in this?this[a]=e[a]:a in this&&delete this[a]}}applyArrayProps(e,t){if(!e)throw new Error("No props passed to applyArrayProps()");if(e.length===0){this.arrayProperties=[];return}for(const a of e)for(const[r,n]of Object.entries(a)){if(!t.includes(r))throw new Error(`Unknown property: ${r}`);if(n===void 0)throw new Error(`Property is not set: ${r}`)}this.arrayProperties=e}}class Lt extends Y{isLocalOnly=!1;async getAuthUrl(){const e={method:"auth.gettoken"};let t=null,a=await this.storage?.get();try{t=(await this.sendRequest({method:"GET"},e,!1)).token}catch{throw this.debugLog("Error acquiring a token","warn"),new Error("Error acquiring a token")}return a||(a={token:t}),a.token=t,"sessionID"in a&&delete a.sessionID,"sessionName"in a&&delete a.sessionName,await this.storage.set(a),`${this.getBaseAuthUrl()}?api_key=${this.getApiKey()}&token=${t||""}`}async getSession(){const e=await this.storage.get();if(!e)throw new Error(f.ERROR_AUTH);if(!("token"in e)){if(!("sessionID"in e))throw new Error(f.ERROR_AUTH);return{sessionID:e.sessionID??"undefined",sessionName:e.sessionName}}const t=e.token||null;if(t!==null)try{const a=await this.tradeTokenForSession(t);return delete e.token,e.sessionID=a.sessionID,e.sessionName=a.sessionName,await this.storage.set(e),a}catch{throw this.debugLog("Failed to trade token for session","warn"),await this.signOut(),new Error(f.ERROR_AUTH)}return{sessionID:e.sessionID,sessionName:e.sessionName}}async isReadyForGrantAccess(){const e=await this.storage.get();return!e||!("token"in e)?!1:!!e.token}async sendNowPlaying(e){const{sessionID:t}=await this.getSession(),a={method:"track.updatenowplaying",track:e.getTrack(),artist:e.getArtist(),sk:t};e.getAlbum()&&(a.album=e.getAlbum()),e.getAlbumArtist()&&(a.albumArtist=e.getAlbumArtist()),e.getDuration()&&(a.duration=`${e.getDuration()??""}`);const r=await this.sendRequest({method:"POST"},a);return this.processResponse(r)}async sendPaused(){return Promise.resolve(f.RESULT_OK)}async sendResumedPlaying(){return Promise.resolve(f.RESULT_OK)}async scrobble(e){const{sessionID:t}=await this.getSession(),a={method:"track.scrobble",sk:t};for(const[g,p]of e.slice(0,50).entries())a[`timestamp[${g}]`]=p.metadata.startTimestamp.toString(),a[`track[${g}]`]=p.getTrack(),a[`artist[${g}]`]=p.getArtist(),p.getAlbum()&&(a[`album[${g}]`]=p.getAlbum()),p.getAlbumArtist()&&(a[`albumArtist[${g}]`]=p.getAlbumArtist());const r=await this.sendRequest({method:"POST"},a),n=this.processResponse(r);if(n===f.RESULT_OK){const g=r.scrobbles;if(g){const p=g["@attr"].ignored;if(Number(p)===0)return new Array(Math.min(e.length,50)).fill(f.RESULT_OK);if(!Array.isArray(g.scrobble))return new Array(Math.min(e.length,50)).fill(f.RESULT_IGNORE);const j={};for(const[k,M]of e.entries())j[M.metadata.startTimestamp.toString()]=k;const R=new Array(Math.min(e.length,50));for(const k of g.scrobble)R[j[k.timestamp]]=k.ignoredMessage.code==="0"?f.RESULT_OK:f.RESULT_IGNORE}else return new Array(Math.min(e.length,50)).fill(f.ERROR_OTHER)}return new Array(Math.min(e.length,50)).fill(n)}async toggleLove(e,t){const{sessionID:a}=await this.getSession(),r={method:t?"track.love":"track.unlove",track:e.getTrack(),artist:e.getArtist(),sk:a},n=await this.sendRequest({method:"POST"},r);return this.processResponse(n)}canLoveSong(){return!0}async sendRequest(e,t,a=!0){const r=this.makeRequestUrl(t,a),n=fetch(r,e),g=this.REQUEST_TIMEOUT;let p=null,j=null;try{p=await _(g,n),j=await p.json()}catch{throw new Error(f.ERROR_OTHER)}const R=JSON.stringify(j,null,2),k=fa(j,R);if(!p.ok)throw this.debugLog(`${t.method} response:
${k}`,"error"),new Error(f.ERROR_OTHER);return this.debugLog(`${t.method} response:
${k}`),j}async tradeTokenForSession(e){const t={method:"auth.getsession",token:e},a=await this.sendRequest({method:"GET"},t);if(this.processResponse(a)!==f.RESULT_OK)throw new Error(f.ERROR_AUTH);const n=a.session.name;return{sessionID:a.session.key,sessionName:n}}makeRequestUrl(e,t){e.api_key=this.getApiKey(),e.format="json",t&&(e.api_sig=this.generateSign(e));const a=tt(e);return`${this.getApiUrl()}?${a}`}generateSign(e){const t=Object.keys(e).sort();let a="";for(const r of t)["format","callback"].includes(r)||(a+=`${r}${e[r]||""}`);return Ts(a+this.getApiSecret())}processResponse(e){return e.error?f.ERROR_OTHER:f.RESULT_OK}}function fa(s,e){let t=e;const a=[s.token],r=s.session;r&&(a.push(r.name),a.push(r.key));for(const n of a)typeof n=="string"?t=Ze(n,t):typeof n=="number"&&(t=Ze(n.toString(),t));return t}class pa extends Lt{getApiUrl(){return"https://ws.audioscrobbler.com/2.0/"}getApiKey(){return"d9bb1870d3269646f740544d9def2c95"}getApiSecret(){return"2160733a567d4a1a69a73fad54c564b2"}getBaseAuthUrl(){return"https://www.last.fm/api/auth/"}getBaseProfileUrl(){return"https://last.fm/user/"}getId(){return"lastfm"}getLabel(){return"Last.fm"}getStatusUrl(){return"http://status.last.fm/"}getStorageName(){return"LastFM"}async getSongInfo(e){const t={track:e.getTrack(),artist:e.getArtist(),method:"track.getinfo"};try{const{sessionName:g}=await this.getSession();t.username=g}catch{}e.getAlbum()&&(t.album=e.getAlbum());const a=await this.sendRequest({method:"GET"},t,!1);if(this.processResponse(a)!==f.RESULT_OK)throw new Error("Unable to load song info");const n=this.parseSongInfo(a);return this.canLoveSong()&&n&&P(e.controllerTabId,{type:"updateLove",payload:{isLoved:n.userloved||!1}}),n}canLoadSongInfo(){return!0}parseSongInfo(e){const t={},a=e.track,r=e.track.album,n=e.track.artist,g=a.userloved;if(g?t.userloved=g==="1":t.userloved=void 0,t.artist=n.name,t.artistUrl=n.url,t.track=a.name,t.trackUrl=a.url,t.duration=parseInt(a.duration)/1e3||null,r&&(t.album=r.title,t.albumUrl=r.url,t.albumMbId=r.mbid,Array.isArray(r.image))){const p=r.image.reduce((R,k)=>(R[k.size]=k["#text"],R),{}),j=["extralarge","large","medium"];for(const R of j){const k=p[R];if(k){t.trackArtUrl=k;break}}}return t.userPlayCount=parseInt(a.userplaycount)||0,t}applyFilter(e){if(e.getAlbumArtist()){const t=e.getAlbumArtist()||"";e.parsed.albumArtist=t.includes("Various Artists")?"Various Artists":t}return e}}class wa extends Lt{getApiUrl(){return"https://libre.fm/2.0/"}getApiKey(){return"r8i1y91hz71tcx7vyrp9hk1alhqp1898"}getApiSecret(){return"8187db5vg234yq6tm7o62q8mtl1niala"}getBaseAuthUrl(){return"https://www.libre.fm/api/auth/"}getBaseProfileUrl(){return"https://libre.fm/user/"}getLabel(){return"Libre.fm"}getStatusUrl(){return""}getStorageName(){return"LibreFM"}async getSongInfo(){return Promise.resolve({})}sendRequest(e,t,a){return e.method?.toLowerCase()==="post"&&(e.headers={"Content-Type":"application/x-www-form-urlencoded"},e.body=tt(t)),super.sendRequest(e,t,a)}}const ja="https://listenbrainz.org/settings/",Ge="https://api.listenbrainz.org/1",ya=`${Ge}/submit-listens`;class Aa extends Y{isLocalOnly=!1;async getSongInfo(){return Promise.resolve({})}async getAuthUrl(){const e=await this.storage.get();let t;return e&&"properties"in e&&(t=e.properties),t?await this.storage.set({isAuthStarted:!0,properties:t}):await this.storage.set({isAuthStarted:!0}),"https://listenbrainz.org/login/musicbrainz?next=%2Fsettings%2F"}getBaseProfileUrl(){return"https://listenbrainz.org/user/"}getLabel(){return"ListenBrainz"}async getProfileUrl(){return this.userToken?"":await super.getProfileUrl()}getStatusUrl(){return this.userToken?"":"https://listenbrainz.org/current-status"}getStorageName(){return"ListenBrainz"}getUserDefinedProperties(){return["userApiUrl","userToken"]}async signOut(){(this.userApiUrl||this.userToken)&&await this.applyUserProperties({userApiUrl:null,userToken:null}),await super.signOut()}async getSession(){if(this.userToken)return{sessionID:this.userToken};const e=await this.storage.get();if(!e)throw this.debugLog("no data","error"),await this.signOut(),new Error(f.ERROR_AUTH);if("isAuthStarted"in e&&e.isAuthStarted)try{const t=await this.requestSession();return e.sessionID=t.sessionID,e.sessionName=t.sessionName,delete e.isAuthStarted,await this.storage.set(e),t}catch{throw this.debugLog("Failed to get session","warn"),await this.signOut(),new Error(f.ERROR_AUTH)}else if(!("sessionID"in e)||!e.sessionID)throw new Error(f.ERROR_AUTH);return{sessionID:e.sessionID,sessionName:e.sessionName}}async isReadyForGrantAccess(){if(this.userToken)return!1;const e=await this.storage.get();return!e||!("isAuthStarted"in e)?!1:e.isAuthStarted??!1}async sendNowPlaying(e){const{sessionID:t}=await this.getSession(),r={listen_type:"playing_now",payload:[{track_metadata:this.makeTrackMetadata(e)}]};return this.sendScrobbleRequest(r,t)}async sendPaused(){return Promise.resolve(f.RESULT_OK)}async sendResumedPlaying(){return Promise.resolve(f.RESULT_OK)}async scrobble(e,t){const{sessionID:a}=await this.getSession(),r={listen_type:t?"single":"import",payload:e.slice(0,50).map(g=>({listened_at:g.metadata.startTimestamp,track_metadata:this.makeTrackMetadata(g)}))},n=await this.sendScrobbleRequest(r,a);return new Array(Math.min(e.length,50)).fill(n)}async toggleLove(e,t){const a=e.getTrack(),r=e.getArtist();if(typeof a!="string"||typeof r!="string")throw new Error(`Invalid track ${JSON.stringify({artist:r,track:a})}`);const n=new URLSearchParams({recording_name:a,artist_name:r});let g={};try{g=await this.listenBrainzApi("GET",`${Ge}/metadata/lookup?${n.toString()}`,null,null)}catch{}if(this.debugLog(`lookup result: ${JSON.stringify(g,null,2)}`),!g.recording_mbid)return this.debugLog(`Could not lookup metadata for song: ${e.toString()}`),{};const{sessionID:p}=await this.getSession(),j={recording_mbid:g.recording_mbid,score:t?1:0},R=await this.listenBrainzApi("POST",`${Ge}/feedback/recording-feedback`,j,p);return this.processResult(R)}canLoveSong(){return!0}async listenBrainzApi(e,t,a,r){const n={method:e,headers:{"Content-Type":"application/json; charset=UTF-8"}};a&&(n.body=JSON.stringify(a)),r&&n.headers&&(n.headers.Authorization=`Token ${r}`);const g=fetch(t,n),p=this.REQUEST_TIMEOUT;let j=null,R=null;try{R=await _(p,g),j=await R.json()}catch{throw this.debugLog("Error while sending request","error"),new Error(f.ERROR_OTHER)}switch(R.status){case 400:throw this.debugLog("Invalid JSON sent","error"),new Error(f.ERROR_AUTH);case 401:throw this.debugLog("Invalid Authorization sent","error"),new Error(f.ERROR_AUTH)}return this.debugLog(JSON.stringify(j,null,2)),j}async sendScrobbleRequest(e,t){const a=await this.listenBrainzApi("POST",this.userApiUrl||ya,e,t);return this.processResult(a)}async requestSession(){let e=null;try{e=await this.fetchSession(ja)}catch{this.debugLog("request session timeout","warn")}if(e){const t=Xe(e.sessionID);return this.debugLog(`Session ID: ${t}`),e}throw new Error(f.ERROR_AUTH)}async fetchSession(e){this.debugLog(`Use ${e}`);const t=Vt()?et(e):es({type:"sendListenBrainzRequest",payload:{url:e}}),a=this.REQUEST_TIMEOUT,r=await _(a,t);if(r!==null){let n=null;const g=r.match(/<script id="global-react-props" type="application\/json">(.*?)<\/script>/)?.[1];g&&(n=JSON.parse(g));const p=n?.current_user.name,j=n?.current_user.auth_token;if(j&&p)return{sessionID:j,sessionName:p}}return null}processResult(e){return e.status!=="ok"?f.ERROR_OTHER:f.RESULT_OK}makeTrackMetadata(e){const t={artist_name:e.getArtist()??"",track_name:e.getTrack()??"",additional_info:{submission_client:"Web Scrobbler",submission_client_version:Xt(),music_service_name:e.metadata.label}},a=e.getAlbum();a&&(t.release_name=a);const r=e.getOriginUrl();r&&(t.additional_info.origin_url=r);const n=e.getAlbumArtist();n&&(t.additional_info.release_artist_name=n),r&&e.metadata.label==="Spotify"&&(t.additional_info.spotify_id=r);const g=e.getDuration();return g&&(t.additional_info.duration=g),t}}class ka extends Y{isLocalOnly=!0;getStorageName(){return"Maloja"}getLabel(){return"Maloja"}getStatusUrl(){return""}getUserDefinedProperties(){return["userApiUrl","userToken"]}async getProfileUrl(){return Promise.resolve("")}async getAuthUrl(){return Promise.resolve("")}getBaseProfileUrl(){return""}getSongInfo(){return Promise.resolve({})}toggleLove(){return Promise.resolve(f.ERROR_OTHER)}async getSession(){if(!this.userToken)throw new Error(f.ERROR_AUTH);return Promise.resolve({sessionID:this.userToken})}isReadyForGrantAccess(){return Promise.resolve(!1)}sendNowPlaying(){return Promise.resolve(f.RESULT_OK)}async sendPaused(){return Promise.resolve(f.RESULT_OK)}async sendResumedPlaying(){return Promise.resolve(f.RESULT_OK)}async scrobble(e){const t=[];for(const a of e.slice(0,50)){const r=this.makeTrackMetadata(a);t.push(this.sendRequest(r,this.userToken))}return Promise.all(t)}async sendRequest(e,t){e.key=t;const a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},r=fetch(this.userApiUrl,a),n=this.REQUEST_TIMEOUT;let g=null;try{if(g=await _(n,r),g.status!==200)return f.ERROR_OTHER}catch{return this.debugLog("Error while sending request","error"),f.ERROR_OTHER}return f.RESULT_OK}makeTrackMetadata(e){const t={artist:e.getArtist()??"",title:e.getTrack()??"",time:e.metadata.startTimestamp},a=e.getAlbum();a&&(t.album=a);const r=e.getAlbumArtist();return r&&(t.albumartists=[r]),t}}class va extends Y{isLocalOnly=!0;getBaseProfileUrl(){return""}getLabel(){return"Webhook"}getStatusUrl(){return""}getStorageName(){return"Webhook"}getSession(){return!this.arrayProperties||this.arrayProperties.length===0?Promise.reject(new Error("")):Promise.resolve({sessionID:"webhook"})}getAuthUrl(){return Promise.resolve("")}isReadyForGrantAccess(){return Promise.resolve(!1)}async getProfileUrl(){return Promise.resolve("")}getUserDefinedArrayProperties(){return["applicationName","userApiUrl"]}async getSongInfo(){return Promise.resolve({})}async sendRequest(e){if(!this.arrayProperties||this.arrayProperties.length===0)return f.ERROR_AUTH;this.debugLog(`Webhook - sendRequest: ${JSON.stringify(e,null,2)}`);const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},a=[];for(const n of this.arrayProperties)a.push(fetch(n.userApiUrl,t));const r=this.REQUEST_TIMEOUT;try{const n=await _(r,Promise.all(a));for(const g of n)if(g.status!==200)return this.debugLog(`Error in ${g.url}.`,"error"),f.ERROR_OTHER}catch{return this.debugLog("Error while sending request","error"),f.ERROR_OTHER}return f.RESULT_OK}async sendNowPlaying(e){return this.sendRequest({eventName:"nowplaying",time:Date.now(),data:{song:e}})}async sendPaused(e){return this.sendRequest({eventName:"paused",time:Date.now(),data:{song:e}})}async sendResumedPlaying(e){return this.sendRequest({eventName:"resumedplaying",time:Date.now(),data:{song:e}})}async scrobble(e,t){const a=await this.sendRequest({eventName:"scrobble",time:Date.now(),data:{song:e[0],songs:e,currentlyPlaying:t}});return new Array(e.length).fill(a)}toggleLove(e,t){return this.sendRequest({eventName:"loved",time:Date.now(),data:{song:e,isLoved:t}})}}class Sa extends Y{isLocalOnly=!0;getStorageName(){return"Pleroma"}getLabel(){return"Pleroma"}getStatusUrl(){return""}getUserDefinedProperties(){return["userApiUrl","userToken"]}async getProfileUrl(){return Promise.resolve("")}async getAuthUrl(){return Promise.resolve("")}getBaseProfileUrl(){return""}getSongInfo(){return Promise.resolve({})}toggleLove(){return Promise.resolve(f.ERROR_OTHER)}async getSession(){if(!this.userToken)throw new Error(f.ERROR_AUTH);const e={method:"GET",headers:{Authorization:`Bearer ${this.userToken}`}},t=`https://${this.userApiUrl}/api/v1/accounts/verify_credentials`,a=fetch(t,e),r=this.REQUEST_TIMEOUT;let n=null;try{if(n=await _(r,a),n.status!==200)throw new Error(f.ERROR_AUTH);const g=await n.json(),p=g?g.fqn:"";return{sessionID:this.userToken,sessionName:p}}catch{throw this.debugLog("Error while sending request","error"),new Error(f.ERROR_AUTH)}}isReadyForGrantAccess(){return Promise.resolve(!1)}sendNowPlaying(){return Promise.resolve(f.RESULT_OK)}async sendResumedPlaying(){return Promise.resolve(f.RESULT_OK)}async sendPaused(){return Promise.resolve(f.RESULT_OK)}async scrobble(e){const t=[];for(const a of e.slice(0,50)){const r=this.makeTrackMetadata(a);t.push(this.sendRequest(r,this.userToken))}return Promise.all(t)}async sendRequest(e,t){const a={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(e)},r=`https://${this.userApiUrl}/api/v1/pleroma/scrobble`,n=fetch(r,a),g=this.REQUEST_TIMEOUT;let p=null;try{if(p=await _(g,n),p.status!==200)return f.ERROR_OTHER}catch{return this.debugLog("Error while sending request","error"),f.ERROR_OTHER}return f.RESULT_OK}makeTrackMetadata(e){const t={artist:e.getArtist()??"",title:e.getTrack()??"",length:e.getDuration(),url:e.parsed.originUrl??""},a=e.getAlbum();return a&&(t.album=a),t}}const Z=[new pa,new wa,new Aa,new ka,new va,new Sa];function xt(s,e){return e.some(t=>t.getLabel()===s.getLabel())}class Ra{boundScrobblers=[];async bindAllScrobblers(){for(const e of Z)try{await e.getSession(),this.bindScrobbler(e)}catch{S(`Unable to bind ${e.getLabel()}`,"warn")}return this.boundScrobblers}bindScrobbler(e){xt(e,this.boundScrobblers)||(this.boundScrobblers.push(e),S(`Bind ${e.getLabel()} scrobbler`))}unbindScrobbler(e){if(xt(e,this.boundScrobblers)){const t=this.boundScrobblers.indexOf(e);this.boundScrobblers.splice(t,1),S(`Unbind ${e.getLabel()} scrobbler`)}else S(`${e.getLabel()} is not bound`,"error")}getSongInfo(e){const t=Z.filter(a=>a.canLoadSongInfo());return S(`Send "get info" request: ${t.length}`),Promise.all(t.map(async a=>{try{return await a.getSongInfo(e)}catch{return S(`Unable to get song info from ${a.getLabel()}`,"warn"),null}}))}sendNowPlaying(e){return S(`Send "now playing" request: ${this.boundScrobblers.length}`),Promise.all(this.boundScrobblers.map(async t=>{try{return await t.sendNowPlaying(t.applyFilter(e))}catch(a){return this.processErrorResult(t,a)}}))}sendPaused(e){const t=this.boundScrobblers.filter(a=>typeof a.sendPaused=="function");return t.length===0?Promise.resolve([f.RESULT_OK]):(S(`Send "paused" request: ${t.length}`),Promise.all(t.map(async a=>{try{return await a.sendPaused(a.applyFilter(e))}catch(r){return this.processErrorResult(a,r)}})))}sendResumedPlaying(e){const t=this.boundScrobblers.filter(a=>typeof a.sendResumedPlaying=="function");return t.length===0?Promise.resolve([f.RESULT_OK]):(S(`Send "paused" request: ${t.length}`),Promise.all(t.map(async a=>{try{return await a.sendResumedPlaying(a.applyFilter(e))}catch(r){return this.processErrorResult(a,r)}})))}async scrobble(e,t){S(`Send "scrobble" request: ${this.boundScrobblers.length}`);const a=await Promise.all(this.boundScrobblers.map(async r=>{try{return await r.scrobble(e.map(r.applyFilter),t)}catch(n){return this.processScrobbleErrorResult(r,n)}}));for(let r=0;r<a[0].length;r++)await Cs.pushScrobble({song:e[r].getCloneableData(),status:is(a,r)});return a}async toggleLove(e,t){const a=Z.filter(n=>n.canLoveSong());return S(`Send "${t?"love":"unlove"}" request: ${a.length}`),Promise.all(a.map(async n=>{try{return await n.toggleLove(e,t)}catch(g){return this.processErrorResult(n,g)}}))}getRegisteredScrobblers(){return Z}getScrobblerByLabel(e){for(const t of Z)if(t.getLabel()===e)return t;return null}async processErrorResult(e,t){const a=t===f.ERROR_OTHER,r=t===f.ERROR_AUTH;if(!(a||r))throw new Error(`Invalid result: ${t}`);return r&&(await e.isReadyForGrantAccess()||this.unbindScrobbler(e)),t}async processScrobbleErrorResult(e,t){const a=t[0]===f.ERROR_OTHER,r=t[0]===f.ERROR_AUTH;if(!(a||r))throw new Error(`Invalid result: ${t[0]}`);return r&&(await e.isReadyForGrantAccess()||this.unbindScrobbler(e)),t}}const x=new Ra;async function Ea(s){return await x.bindAllScrobblers(),aa(s.connector),x.sendNowPlaying(s)}async function Ta(s){return await x.bindAllScrobblers(),x.sendPaused(s)}async function La(s){return await x.bindAllScrobblers(),x.sendResumedPlaying(s)}async function xa(s,e){return await x.bindAllScrobblers(),x.scrobble(s,e)}async function Pa(s){return await x.bindAllScrobblers(),x.getSongInfo(s)}async function Na(s,e){await x.bindAllScrobblers();const t=await x.toggleLove(s,e);if(t.some(a=>a===f.ERROR_OTHER))throw new Error("An error occurred while toggling love for track");return t}const Ke=L(se);b.runtime.onStartup.addListener(Ct),b.runtime.onInstalled.addListener(Ba),b.tabs.onRemoved.addListener(s=>void Ca(s)),b.tabs.onUpdated.addListener((s,e,t)=>void Ua(s,e,t)),b.tabs.onActivated.addListener(s=>void Ia(s)),b.contextMenus?.onClicked.addListener(s=>void Fa(s)),b.commands?.onCommand.addListener(s=>void Oa(s));async function Oa(s){const e=await vt(),t=e.song?.metadata.userloved;switch(s){case"toggle-connector":e.mode===Je?Rt(e.tabId):St(e.tabId);break;case"love-song":t||Pt(e.tabId,!0,!0);break;case"unlove-song":t&&Pt(e.tabId,!1,!0);break}}function Pt(s,e,t){P(s??-1,{type:"toggleLove",payload:{isLoved:e,shouldShowNotification:t}})}async function Ca(s){const e=await me(),t=await Fe(e.activeTabs);await J({activeTabs:t,browserPreferredTheme:e.browserPreferredTheme});const a=await ue();de(t,a);const r=await Ke.get();r?.[s]&&(delete r[s],Ke.set(r))}async function Ia(s){await Nt(s.tabId,!0)}async function Ua(s,e,t){t?.active&&e.status==="complete"&&await Nt(s,!1)}async function Nt(s,e){const t=await me();let a=e?t.activeTabs.filter(g=>g.tabId!==s):t.activeTabs;const r=await qe(a,s);Be[r.mode]&&r.tabId===s&&(e?a=[r,...a]:a=a.map(g=>g.tabId===s?r:g));const n=await Fe(a);await J({activeTabs:n,browserPreferredTheme:t.browserPreferredTheme}),de(n,s)}async function Ot(s,e){if(!s)throw new Error("No tabid given");let t=!1;try{const a=await me(),r=await Fe(a.activeTabs);for(let p=0;p<r.length;p++){if(r[p].tabId!==s)continue;r[p]=e(r[p]),t=!0,await J({activeTabs:r,browserPreferredTheme:a.browserPreferredTheme});const j=await ue();de(r,j);return}t=!0;const n=[e({tabId:s,mode:G,permanentMode:G,song:null}),...r];await J({activeTabs:n,browserPreferredTheme:a.browserPreferredTheme});const g=await ue();de(r,g)}catch{t||qs()}}async function _a(s,e,t){await Ot(s,a=>({tabId:a.tabId,mode:e,permanentMode:t,song:a.song}))}async function Ma(s,e){await Ot(s,t=>({tabId:t.tabId,mode:t.mode,permanentMode:t.permanentMode,song:e}))}at(E({type:"controllerModeChange",fn:({mode:s,permanentMode:e},t)=>{_a(t.tab?.id,s,e),console.log(`changed mode to ${s} in tab ${t.tab?.id}`)}}),E({type:"songUpdate",fn:(s,e)=>{Ma(e.tab?.id,s),console.log(`song changed in tab ${e.tab?.id}`),console.log(s)}}),E({type:"getTabId",fn:(s,e)=>(console.log("getting tab id"),console.log(s,e.tab?.id),e.tab?.id)}),E({type:"showNowPlaying",fn:(s,e)=>{ra(new C(s.song,e.tab?.id??-1),s.connector,()=>{st(e.tab?.id??-1)})}}),E({type:"setNowPlaying",fn:(s,e)=>Ea(new C(s.song,e.tab?.id??-1))}),E({type:"setPaused",fn:(s,e)=>Ta(new C(s.song,e.tab?.id??-1))}),E({type:"setResumedPlaying",fn:(s,e)=>La(new C(s.song,e.tab?.id??-1))}),E({type:"scrobble",fn:(s,e)=>xa(s.songs.map(t=>new C(t,e.tab?.id??-1)),s.currentlyPlaying)}),E({type:"getSongInfo",fn:(s,e)=>Pa(new C(s.song,e.tab?.id??-1))}),E({type:"toggleLove",fn:(s,e)=>{const t=new C(s.song,e.tab?.id??-1);return s.shouldShowNotification&&ua(t,s.isLoved),Na(t,s.isLoved)}}),E({type:"sendListenBrainzRequest",fn:async s=>et(s.url)}),E({type:"clearNowPlaying",fn:(s,e)=>{ia(new C(s.song,e.tab?.id??-1))}}),E({type:"showSongNotRecognized",fn:(s,e)=>{oa(new C(s.song,e.tab?.id??-1),s.connector,()=>{st(e.tab?.id??-1)})}}),E({type:"updateTheme",fn:async s=>{const e=await me();await J({activeTabs:e.activeTabs,browserPreferredTheme:s})}}),E({type:"fetch",fn:async({url:s,init:e})=>{const t=await fetch(s,e);return t.ok?{ok:!0,content:await t.text()}:{ok:!1,content:""}}}),E({type:"isTabAudible",fn:async(s,e)=>{const t=e.tab?.id;return typeof t!="number"?Promise.resolve(!0):(await b.tabs.get(t)).audible??!0}}));async function Da(){const s=L(xe);let e=await s.get();e||(e={appVersion:""}),e.appVersion=b.runtime.getManifest().version,await s.set(e),s.debugLog()}async function za(){return(await x.bindAllScrobblers()).length>0}function Ct(){L(te).set($e),Ke.set({}),Ps(),Da(),za().then(e=>{e||(console.warn("No scrobblers are bound"),da())}),b.contextMenus?.create({id:A.ENABLE_CONNECTOR,visible:!1,contexts:["action"],title:"Error: You should not be seeing this"}),b.contextMenus?.create({id:A.DISABLE_CONNECTOR,visible:!1,contexts:["action"],title:"Error: You should not be seeing this"}),b.contextMenus?.create({id:A.DISABLE_UNTIL_CLOSED,visible:!1,contexts:["action"],title:"Error: You should not be seeing this"}),b.contextMenus.create({id:A.ENABLE_CHANNEL,visible:!1,contexts:["action"],title:"Error: You should not be seeing this"}),b.contextMenus.create({id:A.DISABLE_CHANNEL,visible:!1,contexts:["action"],title:"Error: You should not be seeing this"})}function Ba(){Ct(),ha()}async function Fa(s){const e=await vt();switch(s.menuItemId){case A.ENABLE_CONNECTOR:{Rt(e.tabId);break}case A.DISABLE_CONNECTOR:{St(e.tabId);break}case A.DISABLE_UNTIL_CLOSED:{Js(e.tabId);break}case A.ENABLE_CHANNEL:{Ws(e.tabId);break}case A.DISABLE_CHANNEL:{Ks(e.tabId);break}}}})();
